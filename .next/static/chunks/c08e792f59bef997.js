(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,59825,e=>{"use strict";var a=e.i(43476),s=e.i(71645),t=e.i(46932),l=e.i(46696),i=e.i(98919),r=e.i(69638),n=e.i(73884),d=e.i(70756),o=e.i(55436),c=e.i(7233),m=e.i(16715),x=e.i(97548),u=e.i(15288),h=e.i(19455),p=e.i(93479),g=e.i(67489),j=e.i(86536),b=e.i(88511),y=e.i(27612),v=e.i(81203),f=e.i(41071),N=e.i(73375),k=e.i(63059),w=e.i(61911),C=e.i(84774),S=e.i(55146),_=e.i(87486),T=e.i(63816);let R={getRoles:async(e={})=>(await T.default.get("/api/roles",{params:{search:e.search||void 0,status:"all"===e.status?void 0:e.status,page:e.page||1,per_page:e.per_page||10}})).data,getActiveRoles:async()=>(await T.default.get("/api/roles/active")).data,getRoleById:async e=>(await T.default.get(`/api/roles/${e}`)).data,createRole:async e=>(await T.default.post("/api/roles",e)).data,updateRole:async(e,a)=>(await T.default.put(`/api/roles/${e}`,a)).data,deleteRole:async e=>(await T.default.delete(`/api/roles/${e}`)).data,toggleRoleStatus:async e=>(await T.default.patch(`/api/roles/${e}/toggle-status`)).data,getRoleStats:async()=>(await T.default.get("/api/roles/stats")).data,updateRolePermissions:async(e,a)=>(await T.default.put(`/api/roles/${e}/permissions`,{permissions:a})).data,getPermissionsMatrix:async()=>(await T.default.get("/api/roles/permissions-matrix")).data,getColorOptions:()=>[{value:"red",label:"Merah",class:"bg-red-500"},{value:"blue",label:"Biru",class:"bg-blue-500"},{value:"green",label:"Hijau",class:"bg-green-500"},{value:"yellow",label:"Kuning",class:"bg-yellow-500"},{value:"purple",label:"Ungu",class:"bg-purple-500"},{value:"pink",label:"Pink",class:"bg-pink-500"},{value:"indigo",label:"Indigo",class:"bg-indigo-500"},{value:"cyan",label:"Cyan",class:"bg-cyan-500"},{value:"orange",label:"Oranye",class:"bg-orange-500"},{value:"teal",label:"Teal",class:"bg-teal-500"}],getColorClass(e){let a={red:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",blue:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",green:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",yellow:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",purple:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300",pink:"bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-300",indigo:"bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-300",cyan:"bg-cyan-100 text-cyan-800 dark:bg-cyan-900 dark:text-cyan-300",orange:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300",teal:"bg-teal-100 text-teal-800 dark:bg-teal-900 dark:text-teal-300"};return a[e||"blue"]||a.blue},getSolidColorClass(e){let a={red:"bg-red-500",blue:"bg-blue-500",green:"bg-green-500",yellow:"bg-yellow-500",purple:"bg-purple-500",pink:"bg-pink-500",indigo:"bg-indigo-500",cyan:"bg-cyan-500",orange:"bg-orange-500",teal:"bg-teal-500"};return a[e||"blue"]||a.blue}};function D(){return(0,a.jsxs)(C.TableRow,{children:[(0,a.jsx)(C.TableCell,{children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"h-10 w-10 rounded-xl bg-muted animate-pulse"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"h-4 w-32 bg-muted animate-pulse rounded"}),(0,a.jsx)("div",{className:"h-3 w-20 bg-muted animate-pulse rounded"})]})]})}),(0,a.jsx)(C.TableCell,{children:(0,a.jsx)("div",{className:"h-4 w-48 bg-muted animate-pulse rounded"})}),(0,a.jsx)(C.TableCell,{children:(0,a.jsx)("div",{className:"h-4 w-16 bg-muted animate-pulse rounded"})}),(0,a.jsx)(C.TableCell,{children:(0,a.jsx)("div",{className:"h-4 w-16 bg-muted animate-pulse rounded"})}),(0,a.jsx)(C.TableCell,{children:(0,a.jsx)("div",{className:"h-6 w-16 bg-muted animate-pulse rounded-full"})}),(0,a.jsx)(C.TableCell,{children:(0,a.jsx)("div",{className:"h-8 w-8 bg-muted animate-pulse rounded"})})]})}function P(){return(0,a.jsx)(C.TableRow,{children:(0,a.jsx)(C.TableCell,{colSpan:6,className:"h-48",children:(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center text-center",children:[(0,a.jsx)("div",{className:"p-4 rounded-full bg-muted/50 mb-4",children:(0,a.jsx)(i.Shield,{className:"h-8 w-8 text-muted-foreground"})}),(0,a.jsx)("h3",{className:"font-semibold text-lg",children:"Tidak ada role"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Belum ada role yang sesuai dengan filter"})]})})})}function A({roles:e,isLoading:s=!1,currentPage:l,totalPages:r,onPageChange:n,onView:o,onEdit:c,onDelete:m,onToggleStatus:x}){return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"rounded-xl border bg-card overflow-hidden",children:(0,a.jsxs)(C.Table,{children:[(0,a.jsx)(C.TableHeader,{children:(0,a.jsxs)(C.TableRow,{className:"bg-muted/50 hover:bg-muted/50",children:[(0,a.jsx)(C.TableHead,{className:"font-semibold",children:"Role"}),(0,a.jsx)(C.TableHead,{className:"font-semibold",children:"Deskripsi"}),(0,a.jsx)(C.TableHead,{className:"font-semibold w-[120px]",children:"Permissions"}),(0,a.jsx)(C.TableHead,{className:"font-semibold w-[100px]",children:"Users"}),(0,a.jsx)(C.TableHead,{className:"font-semibold w-[100px]",children:"Status"}),(0,a.jsx)(C.TableHead,{className:"font-semibold w-[80px]",children:"Aksi"})]})}),(0,a.jsx)(C.TableBody,{children:s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(D,{}),(0,a.jsx)(D,{}),(0,a.jsx)(D,{}),(0,a.jsx)(D,{}),(0,a.jsx)(D,{})]}):0===e.length?(0,a.jsx)(P,{}):e.map((e,s)=>(0,a.jsxs)(t.motion.tr,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.05*s},className:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",children:[(0,a.jsx)(C.TableCell,{children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:`p-2.5 rounded-xl ${R.getSolidColorClass(e.color)} text-white`,children:(0,a.jsx)(i.Shield,{className:"h-5 w-5"})}),(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("p",{className:"font-medium truncate",children:e.display_name}),e.is_system&&(0,a.jsx)(d.Lock,{className:"h-3.5 w-3.5 text-muted-foreground"})]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e.name})]})]})}),(0,a.jsx)(C.TableCell,{children:(0,a.jsx)("p",{className:"text-sm text-muted-foreground truncate max-w-xs",children:e.description||"-"})}),(0,a.jsx)(C.TableCell,{children:(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)(i.Shield,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{className:"font-medium",children:e.permissions_count||0})]})}),(0,a.jsx)(C.TableCell,{children:(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)(w.Users,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{className:"font-medium",children:e.users_count||0})]})}),(0,a.jsx)(C.TableCell,{children:(0,a.jsx)(_.Badge,{variant:e.is_active?"success":"error",children:e.is_active?"Aktif":"Nonaktif"})}),(0,a.jsx)(C.TableCell,{children:(0,a.jsxs)(S.DropdownMenu,{children:[(0,a.jsx)(S.DropdownMenuTrigger,{asChild:!0,children:(0,a.jsxs)(h.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",children:[(0,a.jsx)(f.MoreHorizontal,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Buka menu"})]})}),(0,a.jsxs)(S.DropdownMenuContent,{align:"end",className:"w-48",children:[(0,a.jsxs)(S.DropdownMenuItem,{onClick:()=>o(e),children:[(0,a.jsx)(j.Eye,{className:"mr-2 h-4 w-4"}),"Lihat Detail"]}),(0,a.jsxs)(S.DropdownMenuItem,{onClick:()=>c(e),children:[(0,a.jsx)(b.Edit,{className:"mr-2 h-4 w-4"}),"Edit"]}),!e.is_system&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(S.DropdownMenuItem,{onClick:()=>x(e),children:[(0,a.jsx)(v.Power,{className:"mr-2 h-4 w-4"}),e.is_active?"Nonaktifkan":"Aktifkan"]}),(0,a.jsx)(S.DropdownMenuSeparator,{}),(0,a.jsxs)(S.DropdownMenuItem,{onClick:()=>m(e),className:"text-destructive focus:text-destructive",disabled:(e.users_count||0)>0,children:[(0,a.jsx)(y.Trash2,{className:"mr-2 h-4 w-4"}),"Hapus"]})]})]})]})})]},e.id))})]})}),r>1&&(0,a.jsxs)("div",{className:"flex items-center justify-between px-2",children:[(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Halaman ",l," dari ",r]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(h.Button,{variant:"outline",size:"sm",onClick:()=>n(l-1),disabled:l<=1,children:[(0,a.jsx)(N.ChevronLeft,{className:"h-4 w-4 mr-1"}),"Sebelumnya"]}),(0,a.jsxs)(h.Button,{variant:"outline",size:"sm",onClick:()=>n(l+1),disabled:l>=r,children:["Selanjutnya",(0,a.jsx)(k.ChevronRight,{className:"h-4 w-4 ml-1"})]})]})]})]})}var B=e.i(53145),L=e.i(94814),H=e.i(88653),E=e.i(88081),I=e.i(78583),z=e.i(47780),$=e.i(31278),M=e.i(63209),F=e.i(76639),O=e.i(10204),K=e.i(99375),U=e.i(57428),G=e.i(73443),V=e.i(50270);let W=V.z.object({name:V.z.string().min(1,"Nama role wajib diisi").max(50,"Nama maksimal 50 karakter").regex(/^[a-z_]+$/,"Nama hanya boleh huruf kecil dan underscore (contoh: admin_klinik)"),display_name:V.z.string().min(1,"Nama tampilan wajib diisi").max(100,"Nama tampilan maksimal 100 karakter"),description:V.z.string().max(1e3,"Deskripsi maksimal 1000 karakter").optional().nullable().or(V.z.literal("")),color:V.z.string().max(20,"Warna maksimal 20 karakter").optional(),is_active:V.z.boolean().optional().default(!0),permissions:V.z.array(V.z.number()).optional()}),X={getPermissions:async(e={})=>(await T.default.get("/api/permissions",{params:{search:e.search||void 0,module:"all"===e.module?void 0:e.module,action:"all"===e.action?void 0:e.action,page:e.page||1,per_page:e.per_page||50}})).data,getGroupedPermissions:async()=>(await T.default.get("/api/permissions/grouped")).data,getPermissionById:async e=>(await T.default.get(`/api/permissions/${e}`)).data,getPermissionStats:async()=>(await T.default.get("/api/permissions/stats")).data,getModules:async()=>(await T.default.get("/api/permissions/modules")).data,getModuleLabels:()=>({dashboard:"Dashboard",users:"Pengguna",roles:"Hak Akses",departments:"Departemen",services:"Layanan",icd_codes:"Kode ICD",clinic_settings:"Pengaturan Klinik",patients:"Pasien",appointments:"Janji Temu",medical_records:"Rekam Medis",prescriptions:"Resep",billing:"Tagihan",payments:"Pembayaran",pharmacy:"Farmasi",inventory:"Inventaris",reports:"Laporan"}),getActionLabels:()=>({view:"Lihat",create:"Tambah",edit:"Edit",delete:"Hapus",manage:"Kelola",export:"Export"}),getActionColorClass(e){let a={view:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",create:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",edit:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",delete:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",manage:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300",export:"bg-cyan-100 text-cyan-800 dark:bg-cyan-900 dark:text-cyan-300"};return a[e]||a.view}};function J({open:e,onOpenChange:l,role:r,onSuccess:n}){let d=!!r,[o,c]=(0,s.useState)(!1),[m,x]=(0,s.useState)([]),[u,j]=(0,s.useState)([]),{register:b,handleSubmit:y,setValue:v,watch:f,reset:N,control:k,formState:{errors:w}}=(0,B.useForm)({resolver:(0,L.zodResolver)(W),defaultValues:{name:"",display_name:"",description:"",color:"blue",is_active:!0,permissions:[]}}),C=f("color"),S=f("is_active");(0,s.useEffect)(()=>{let a=async()=>{try{let e=await R.getPermissionsMatrix();x(e.data)}catch(e){console.error("Error fetching permissions:",e)}};e&&a()},[e]),(0,s.useEffect)(()=>{e&&(r?(N({name:r.name,display_name:r.display_name,description:r.description||"",color:r.color||"blue",is_active:r.is_active,permissions:r.permissions?.map(e=>e.id)||[]}),j(r.permissions?.map(e=>e.id)||[])):(N({name:"",display_name:"",description:"",color:"blue",is_active:!0,permissions:[]}),j([])))},[e,r,N]);let _=e=>{let a=e.map(e=>e.id);a.every(e=>u.includes(e))?j(e=>e.filter(e=>!a.includes(e))):j(e=>[...new Set([...e,...a])])},T=async e=>{c(!0);try{let a={...e,permissions:u};d&&r?await R.updateRole(r.id,a):await R.createRole(a),n(),l(!1)}catch(e){console.error("Error saving role:",e)}finally{c(!1)}},D=R.getColorOptions(),P=X.getActionLabels();return(0,a.jsx)(F.Dialog,{open:e,onOpenChange:l,children:(0,a.jsxs)(F.DialogContent,{className:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)(F.DialogHeader,{children:[(0,a.jsx)(F.DialogTitle,{className:"text-xl",children:d?"Edit Role":"Tambah Role Baru"}),(0,a.jsx)(F.DialogDescription,{children:d?"Perbarui informasi role dan hak akses.":"Isi informasi role baru dan pilih hak akses."})]}),(0,a.jsxs)("form",{onSubmit:y(T),className:"space-y-5 py-4",children:[(0,a.jsxs)(t.motion.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"flex items-center justify-center gap-4",children:[(0,a.jsx)("div",{className:`p-4 rounded-2xl ${R.getSolidColorClass(C||"blue")} text-white`,children:(0,a.jsx)(i.Shield,{className:"h-10 w-10"})}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Preview warna role"}),(0,a.jsxs)("p",{className:"font-medium mt-1",children:[u.length," permission dipilih"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)(t.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},className:"space-y-2",children:[(0,a.jsxs)(O.Label,{htmlFor:"name",className:"text-sm font-medium",children:["Nama Role ",(0,a.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(E.Hash,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(p.Input,{id:"name",placeholder:"admin_klinik",className:"pl-10 lowercase",...b("name"),onChange:e=>v("name",e.target.value.toLowerCase().replace(/\s/g,"_")),disabled:d&&r?.is_system})]}),(0,a.jsx)(H.AnimatePresence,{children:w.name&&(0,a.jsxs)(t.motion.p,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"text-sm text-destructive flex items-center gap-1",children:[(0,a.jsx)(M.AlertCircle,{className:"h-3 w-3"}),w.name.message]})})]}),(0,a.jsxs)(t.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.15},className:"space-y-2",children:[(0,a.jsxs)(O.Label,{htmlFor:"display_name",className:"text-sm font-medium",children:["Nama Tampilan ",(0,a.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(i.Shield,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(p.Input,{id:"display_name",placeholder:"Admin Klinik",className:"pl-10",...b("display_name")})]}),(0,a.jsx)(H.AnimatePresence,{children:w.display_name&&(0,a.jsxs)(t.motion.p,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"text-sm text-destructive flex items-center gap-1",children:[(0,a.jsx)(M.AlertCircle,{className:"h-3 w-3"}),w.display_name.message]})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsxs)(t.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"col-span-2 space-y-2",children:[(0,a.jsx)(O.Label,{htmlFor:"description",className:"text-sm font-medium",children:"Deskripsi"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(I.FileText,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,a.jsx)("textarea",{id:"description",placeholder:"Deskripsi singkat role...",className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 pl-10 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 resize-none",...b("description")})]})]}),(0,a.jsxs)(t.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.25},className:"space-y-2",children:[(0,a.jsx)(O.Label,{className:"text-sm font-medium",children:"Warna"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(z.Palette,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground z-10"}),(0,a.jsx)(B.Controller,{name:"color",control:k,render:({field:e})=>(0,a.jsxs)(g.Select,{value:e.value||"",onValueChange:e.onChange,children:[(0,a.jsx)(g.SelectTrigger,{className:"pl-10",children:(0,a.jsx)(g.SelectValue,{placeholder:"Pilih warna",children:e.value&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:`w-4 h-4 rounded-full ${D.find(a=>a.value===e.value)?.class}`}),(0,a.jsx)("span",{className:"text-xs",children:D.find(a=>a.value===e.value)?.label})]})})}),(0,a.jsx)(g.SelectContent,{children:D.map(e=>(0,a.jsx)(g.SelectItem,{value:e.value,children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:`w-4 h-4 rounded-full ${e.class}`}),(0,a.jsx)("span",{children:e.label})]})},e.value))})]})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-3 mt-4",children:[(0,a.jsx)("div",{className:"space-y-0.5",children:(0,a.jsx)(O.Label,{htmlFor:"is_active",className:"text-sm font-medium",children:"Status Aktif"})}),(0,a.jsx)(K.Switch,{id:"is_active",checked:S,onCheckedChange:e=>v("is_active",e),disabled:d&&r?.is_system})]})]})]}),(0,a.jsxs)(t.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},className:"space-y-3",children:[(0,a.jsx)(O.Label,{className:"text-sm font-medium",children:"Hak Akses / Permissions"}),(0,a.jsx)("div",{className:"border rounded-lg",children:(0,a.jsx)(G.Accordion,{type:"multiple",className:"w-full",children:m.map(e=>{var s;let t;return(0,a.jsxs)(G.AccordionItem,{value:e.module,children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"pl-4 pr-2 py-4 cursor-pointer",onClick:a=>{a.stopPropagation(),_(e.permissions)},children:(0,a.jsx)(U.Checkbox,{checked:e.permissions.every(e=>u.includes(e.id)),onCheckedChange:()=>_(e.permissions),className:(t=(s=e.permissions).filter(e=>u.includes(e.id))).length>0&&t.length<s.length?"opacity-50":""})}),(0,a.jsx)(G.AccordionTrigger,{className:"flex-1 pr-4 hover:no-underline",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"font-medium",children:e.label}),(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",e.permissions.filter(e=>u.includes(e.id)).length,"/",e.permissions.length,")"]})]})})]}),(0,a.jsx)(G.AccordionContent,{className:"px-4 pb-4",children:(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:e.permissions.map(e=>(0,a.jsxs)("label",{className:"flex items-center gap-2 p-2 rounded-lg hover:bg-muted cursor-pointer",children:[(0,a.jsx)(U.Checkbox,{checked:u.includes(e.id),onCheckedChange:()=>{var a;return a=e.id,void j(e=>e.includes(a)?e.filter(e=>e!==a):[...e,a])}}),(0,a.jsx)("span",{className:"text-sm",children:P[e.action]||e.action})]},e.id))})})]},e.module)})})})]})]}),(0,a.jsxs)(F.DialogFooter,{className:"gap-2 sm:gap-0",children:[(0,a.jsx)(h.Button,{type:"button",variant:"outline",onClick:()=>l(!1),disabled:o,children:"Batal"}),(0,a.jsx)(h.Button,{type:"submit",onClick:y(T),disabled:o,className:"min-w-[100px]",children:o?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)($.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Menyimpan..."]}):d?"Simpan Perubahan":"Tambah Role"})]})]})})}var Y=e.i(87316),q=e.i(43531),Q=e.i(72436),Z=e.i(75157);function ee({open:e,onOpenChange:s,role:l,onEdit:o,onToggleStatus:c}){if(!l)return null;let m=X.getModuleLabels(),x=X.getActionLabels(),u=l.permissions?.reduce((e,a)=>(e[a.module]||(e[a.module]=[]),e[a.module].push(a),e),{})||{};return(0,a.jsx)(F.Dialog,{open:e,onOpenChange:s,children:(0,a.jsxs)(F.DialogContent,{className:"sm:max-w-[550px] max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(F.DialogHeader,{children:(0,a.jsx)(F.DialogTitle,{className:"text-xl",children:"Detail Role"})}),(0,a.jsxs)("div",{className:"py-4 space-y-6",children:[(0,a.jsxs)(t.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex flex-col items-center text-center",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:`p-5 rounded-2xl ${R.getSolidColorClass(l.color)} text-white`,children:(0,a.jsx)(i.Shield,{className:"h-12 w-12"})}),(0,a.jsx)("div",{className:`absolute -bottom-1 -right-1 w-6 h-6 rounded-full border-2 border-background flex items-center justify-center ${l.is_active?"bg-emerald-500":"bg-gray-400"}`,children:l.is_active?(0,a.jsx)(r.CheckCircle,{className:"h-4 w-4 text-white"}):(0,a.jsx)(n.XCircle,{className:"h-4 w-4 text-white"})})]}),(0,a.jsxs)("div",{className:"mt-4 flex items-center gap-2",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:l.display_name}),l.is_system&&(0,a.jsx)(d.Lock,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:l.name}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)(_.Badge,{variant:l.is_active?"success":"error",children:l.is_active?"Aktif":"Nonaktif"}),l.is_system&&(0,a.jsx)(_.Badge,{variant:"secondary",children:"System Role"})]})]}),(0,a.jsx)(Q.Separator,{}),(0,a.jsxs)(t.motion.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.1},className:"space-y-3",children:[l.description&&(0,a.jsxs)("div",{className:"p-3 rounded-lg bg-muted/50",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Deskripsi"}),(0,a.jsx)("p",{className:"text-sm",children:l.description})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted/50",children:[(0,a.jsx)("div",{className:"p-2 rounded-lg bg-blue-100 dark:bg-blue-950",children:(0,a.jsx)(i.Shield,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Permissions"}),(0,a.jsx)("p",{className:"text-lg font-semibold",children:l.permissions_count||0})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted/50",children:[(0,a.jsx)("div",{className:"p-2 rounded-lg bg-green-100 dark:bg-green-950",children:(0,a.jsx)(w.Users,{className:"h-4 w-4 text-green-600 dark:text-green-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Pengguna"}),(0,a.jsx)("p",{className:"text-lg font-semibold",children:l.users_count||0})]})]})]}),Object.keys(u).length>0&&(0,a.jsxs)("div",{className:"p-3 rounded-lg bg-muted/50 space-y-3",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground font-medium",children:"Hak Akses"}),(0,a.jsx)("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:Object.entries(u).map(([e,s])=>(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)("div",{className:"min-w-[120px] text-sm font-medium",children:m[e]||e}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:s?.map(e=>(0,a.jsxs)(_.Badge,{variant:"outline",className:"text-xs",children:[(0,a.jsx)(q.Check,{className:"h-2.5 w-2.5 mr-1"}),x[e.action]||e.action]},e.id))})]},e))})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted/50",children:[(0,a.jsx)("div",{className:"p-2 rounded-lg bg-orange-100 dark:bg-orange-950",children:(0,a.jsx)(Y.Calendar,{className:"h-4 w-4 text-orange-600 dark:text-orange-400"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Dibuat Pada"}),(0,a.jsx)("p",{className:"text-sm font-medium",children:(0,Z.formatDate)(l.created_at)})]})]})]}),(0,a.jsx)(Q.Separator,{}),(0,a.jsxs)(t.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"flex gap-2",children:[(0,a.jsxs)(h.Button,{variant:"outline",className:"flex-1",onClick:()=>{s(!1),o()},children:[(0,a.jsx)(b.Edit,{className:"mr-2 h-4 w-4"}),"Edit"]}),!l.is_system&&(0,a.jsxs)(h.Button,{variant:l.is_active?"destructive":"default",className:"flex-1",onClick:()=>{s(!1),c()},children:[(0,a.jsx)(v.Power,{className:"mr-2 h-4 w-4"}),l.is_active?"Nonaktifkan":"Aktifkan"]})]})]})]})})}var ea=e.i(78894);function es({open:e,onOpenChange:l,role:r,onConfirm:n}){let[d,o]=(0,s.useState)(!1);if(!r)return null;let c=async()=>{o(!0);try{await n(),l(!1)}catch(e){console.error("Error deleting role:",e)}finally{o(!1)}},m=(r.users_count||0)>0;return(0,a.jsx)(F.Dialog,{open:e,onOpenChange:l,children:(0,a.jsxs)(F.DialogContent,{className:"sm:max-w-[400px]",children:[(0,a.jsxs)(F.DialogHeader,{children:[(0,a.jsxs)(F.DialogTitle,{className:"text-xl text-destructive flex items-center gap-2",children:[(0,a.jsx)(ea.AlertTriangle,{className:"h-5 w-5"}),"Hapus Role"]}),(0,a.jsx)(F.DialogDescription,{children:m?"Role ini tidak dapat dihapus karena masih memiliki pengguna.":"Tindakan ini tidak dapat dibatalkan. Data role akan dihapus secara permanen."})]}),(0,a.jsxs)(t.motion.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"py-4",children:[(0,a.jsxs)("div",{className:`flex items-center gap-4 p-4 rounded-xl ${m?"bg-yellow-50 dark:bg-yellow-950/20 border border-yellow-200 dark:border-yellow-800":"bg-destructive/10 border border-destructive/20"}`,children:[(0,a.jsx)("div",{className:`p-3 rounded-xl ${R.getSolidColorClass(r.color)} text-white`,children:(0,a.jsx)(i.Shield,{className:"h-8 w-8"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h4",{className:"font-semibold truncate",children:r.display_name}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground truncate",children:r.name}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,a.jsx)(_.Badge,{variant:r.is_active?"success":"error",children:r.is_active?"Aktif":"Nonaktif"}),m&&(0,a.jsxs)(_.Badge,{variant:"outline",className:"gap-1",children:[(0,a.jsx)(w.Users,{className:"h-3 w-3"}),r.users_count," pengguna"]})]})]})]}),m?(0,a.jsx)("p",{className:"mt-4 text-sm text-yellow-600 dark:text-yellow-400 text-center",children:"Hapus atau pindahkan pengguna dari role ini terlebih dahulu."}):(0,a.jsx)("p",{className:"mt-4 text-sm text-muted-foreground text-center",children:"Apakah Anda yakin ingin menghapus role ini?"})]}),(0,a.jsxs)(F.DialogFooter,{className:"gap-2 sm:gap-0",children:[(0,a.jsx)(h.Button,{type:"button",variant:"outline",onClick:()=>l(!1),disabled:d,children:"Batal"}),(0,a.jsx)(h.Button,{type:"button",variant:"destructive",onClick:c,disabled:d||m,className:"min-w-[100px]",children:d?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)($.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Menghapus..."]}):"Ya, Hapus"})]})]})})}let et=[{key:"total",title:"Total Role",icon:i.Shield,gradient:"from-blue-500 to-blue-600",bgLight:"bg-blue-50 dark:bg-blue-950/50",iconColor:"text-blue-600 dark:text-blue-400"},{key:"active",title:"Role Aktif",icon:r.CheckCircle,gradient:"from-emerald-500 to-emerald-600",bgLight:"bg-emerald-50 dark:bg-emerald-950/50",iconColor:"text-emerald-600 dark:text-emerald-400"},{key:"inactive",title:"Role Nonaktif",icon:n.XCircle,gradient:"from-red-500 to-red-600",bgLight:"bg-red-50 dark:bg-red-950/50",iconColor:"text-red-600 dark:text-red-400"},{key:"system",title:"System Role",icon:d.Lock,gradient:"from-purple-500 to-purple-600",bgLight:"bg-purple-50 dark:bg-purple-950/50",iconColor:"text-purple-600 dark:text-purple-400"}];function el(){let[e,i]=(0,s.useState)([]),[r,n]=(0,s.useState)(null),[d,j]=(0,s.useState)(!0),[b,y]=(0,s.useState)(!1),[v,f]=(0,s.useState)(1),[N,k]=(0,s.useState)(1),[w,C]=(0,s.useState)({search:"",status:"all",page:1,per_page:10}),[S,_]=(0,s.useState)(!1),[T,D]=(0,s.useState)(!1),[P,B]=(0,s.useState)(!1),[L,H]=(0,s.useState)(null),E=(0,s.useCallback)(async()=>{try{let e=await R.getRoles(w);i(e.data),f(e.meta.current_page),k(e.meta.last_page)}catch(e){console.error("Error fetching roles:",e),l.toast.error("Gagal memuat data role")}},[w]),I=(0,s.useCallback)(async()=>{try{let e=await R.getRoleStats();n(e.data)}catch(e){console.error("Error fetching stats:",e)}},[]);(0,s.useEffect)(()=>{(async()=>{j(!0),await Promise.all([E(),I()]),j(!1)})()},[E,I]);let z=async()=>{y(!0),await Promise.all([E(),I()]),y(!1),l.toast.success("Data berhasil diperbarui")};(0,s.useEffect)(()=>{let e=setTimeout(()=>{C(e=>({...e,page:1}))},300);return()=>clearTimeout(e)},[w.search]);let $=(e,a)=>{C(s=>({...s,[e]:a,page:1}))},M=async e=>{try{let a=await R.getRoleById(e.id);H(a.data),D(!0)}catch(e){console.error("Error fetching role details:",e),l.toast.error("Gagal memuat detail role")}},F=async e=>{try{let a=await R.getRoleById(e.id);H(a.data),_(!0)}catch(e){console.error("Error fetching role details:",e),l.toast.error("Gagal memuat detail role")}},O=async e=>{try{await R.toggleRoleStatus(e.id),l.toast.success(e.is_active?"Role berhasil dinonaktifkan":"Role berhasil diaktifkan"),await Promise.all([E(),I()])}catch(e){console.error("Error toggling status:",e),l.toast.error("Gagal mengubah status role")}},K=async()=>{l.toast.success(L?"Role berhasil diperbarui":"Role berhasil dibuat"),await Promise.all([E(),I()])},U=async()=>{if(L)try{await R.deleteRole(L.id),l.toast.success("Role berhasil dihapus"),await Promise.all([E(),I()])}catch(e){throw console.error("Error deleting role:",e),l.toast.error("Gagal menghapus role"),e}},G={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(t.motion.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl md:text-3xl font-bold",children:"Hak Akses"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-1",children:"Kelola role dan permission pengguna"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(h.Button,{variant:"outline",size:"sm",onClick:z,disabled:b,children:[(0,a.jsx)(m.RefreshCw,{className:`h-4 w-4 mr-2 ${b?"animate-spin":""}`}),"Refresh"]}),(0,a.jsxs)(h.Button,{size:"sm",onClick:()=>{H(null),_(!0)},children:[(0,a.jsx)(c.Plus,{className:"h-4 w-4 mr-2"}),"Tambah Role"]})]})]}),(0,a.jsx)(t.motion.div,{variants:{hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},initial:"hidden",animate:"show",className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:et.map(e=>{var s;return(0,a.jsx)(t.motion.div,{variants:G,children:(0,a.jsxs)(u.Card,{className:"relative overflow-hidden hover:shadow-lg transition-shadow",children:[(0,a.jsxs)(u.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsx)(u.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:e.title}),(0,a.jsx)("div",{className:`p-2.5 rounded-xl ${e.bgLight}`,children:(0,a.jsx)(e.icon,{className:`h-5 w-5 ${e.iconColor}`})})]}),(0,a.jsx)(u.CardContent,{children:(0,a.jsx)("div",{className:"text-2xl md:text-3xl font-bold",children:d?(0,a.jsx)("div",{className:"h-8 w-16 bg-muted animate-pulse rounded"}):(s=e.key,r&&r[s]||0)})}),(0,a.jsx)("div",{className:`absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r ${e.gradient}`})]})},e.key)})}),(0,a.jsx)(t.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},children:(0,a.jsx)(u.Card,{children:(0,a.jsx)(u.CardContent,{className:"pt-6",children:(0,a.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(o.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(p.Input,{placeholder:"Cari nama role...",className:"pl-10",value:w.search,onChange:e=>$("search",e.target.value)})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(x.Filter,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsxs)(g.Select,{value:w.status,onValueChange:e=>$("status",e),children:[(0,a.jsx)(g.SelectTrigger,{className:"w-[160px]",children:(0,a.jsx)(g.SelectValue,{placeholder:"Status"})}),(0,a.jsxs)(g.SelectContent,{children:[(0,a.jsx)(g.SelectItem,{value:"all",children:"Semua Status"}),(0,a.jsx)(g.SelectItem,{value:"active",children:"Aktif"}),(0,a.jsx)(g.SelectItem,{value:"inactive",children:"Nonaktif"})]})]})]})]})})})}),(0,a.jsx)(t.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},children:(0,a.jsx)(A,{roles:e,isLoading:d,currentPage:v,totalPages:N,onPageChange:e=>{C(a=>({...a,page:e}))},onView:M,onEdit:F,onDelete:e=>{H(e),B(!0)},onToggleStatus:O})}),(0,a.jsx)(J,{open:S,onOpenChange:_,role:L,onSuccess:K}),(0,a.jsx)(ee,{open:T,onOpenChange:D,role:L,onEdit:()=>{D(!1),_(!0)},onToggleStatus:()=>{L&&O(L)}}),(0,a.jsx)(es,{open:P,onOpenChange:B,role:L,onConfirm:U})]})}e.s(["default",()=>el],59825)}]);