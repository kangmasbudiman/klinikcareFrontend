(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,17787,e=>{"use strict";var a=e.i(43476),s=e.i(71645),t=e.i(46932),n=e.i(20286),i=e.i(16715),r=e.i(3116),l=e.i(69638),d=e.i(61911),c=e.i(17835),o=e.i(7486),m=e.i(91741),u=e.i(17697),x=e.i(82293),h=e.i(19455),p=e.i(15288),g=e.i(67489),j=e.i(87486),v=e.i(77572),b=e.i(71689),y=e.i(56909),f=e.i(84614),N=e.i(87316),k=e.i(78583),_=e.i(12156),w=e.i(75254);let C=(0,w.default)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);var T=e.i(31278);let S=(0,w.default)("NotebookPen",[["path",{d:"M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4",key:"re6nr2"}],["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["path",{d:"M21.378 5.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"pqwjuv"}]]);var L=e.i(24687),P=e.i(10204),I=e.i(93479),B=e.i(72436),R=e.i(90597),M=e.i(10059);let E=(0,w.default)("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]),q=(0,w.default)("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]),A=(0,w.default)("Wind",[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]]),D=(0,w.default)("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);function H({values:e,onChange:s,disabled:t}){let n=(e,a)=>{s(e,""===a?null:parseFloat(a))},i=e.weight&&e.height?(e.weight/Math.pow(e.height/100,2)).toFixed(1):null,r=e=>e<18.5?{label:"Kurus",color:"text-yellow-600"}:e<25?{label:"Normal",color:"text-green-600"}:e<30?{label:"Gemuk",color:"text-orange-600"}:{label:"Obesitas",color:"text-red-600"};return(0,a.jsxs)(p.Card,{children:[(0,a.jsx)(p.CardHeader,{className:"pb-4",children:(0,a.jsxs)(p.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,a.jsx)(R.Heart,{className:"h-5 w-5 text-red-500"}),"Tanda Vital (Vital Signs)"]})}),(0,a.jsx)(p.CardContent,{children:(0,a.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(P.Label,{className:"flex items-center gap-1",children:[(0,a.jsx)(D,{className:"h-4 w-4 text-red-500"}),"Tekanan Darah"]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(I.Input,{type:"number",placeholder:"Sistolik",value:e.blood_pressure_systolic??"",onChange:e=>n("blood_pressure_systolic",e.target.value),disabled:t,className:"w-20"}),(0,a.jsx)("span",{children:"/"}),(0,a.jsx)(I.Input,{type:"number",placeholder:"Diastolik",value:e.blood_pressure_diastolic??"",onChange:e=>n("blood_pressure_diastolic",e.target.value),disabled:t,className:"w-20"}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"mmHg"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(P.Label,{className:"flex items-center gap-1",children:[(0,a.jsx)(R.Heart,{className:"h-4 w-4 text-red-500"}),"Denyut Nadi"]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(I.Input,{type:"number",placeholder:"60-100",value:e.heart_rate??"",onChange:e=>n("heart_rate",e.target.value),disabled:t}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"bpm"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(P.Label,{className:"flex items-center gap-1",children:[(0,a.jsx)(A,{className:"h-4 w-4 text-blue-500"}),"Frekuensi Napas"]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(I.Input,{type:"number",placeholder:"12-20",value:e.respiratory_rate??"",onChange:e=>n("respiratory_rate",e.target.value),disabled:t}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"x/mnt"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(P.Label,{className:"flex items-center gap-1",children:[(0,a.jsx)(M.Thermometer,{className:"h-4 w-4 text-orange-500"}),"Suhu Tubuh"]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(I.Input,{type:"number",step:"0.1",placeholder:"36.5",value:e.temperature??"",onChange:e=>n("temperature",e.target.value),disabled:t}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Â°C"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(P.Label,{className:"flex items-center gap-1",children:[(0,a.jsx)(D,{className:"h-4 w-4 text-blue-500"}),"Saturasi O2"]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(I.Input,{type:"number",placeholder:"95-100",value:e.oxygen_saturation??"",onChange:e=>n("oxygen_saturation",e.target.value),disabled:t}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"%"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(P.Label,{className:"flex items-center gap-1",children:[(0,a.jsx)(E,{className:"h-4 w-4 text-green-500"}),"Berat Badan"]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(I.Input,{type:"number",step:"0.1",placeholder:"60",value:e.weight??"",onChange:e=>n("weight",e.target.value),disabled:t}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"kg"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(P.Label,{className:"flex items-center gap-1",children:[(0,a.jsx)(q,{className:"h-4 w-4 text-purple-500"}),"Tinggi Badan"]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(I.Input,{type:"number",step:"0.1",placeholder:"170",value:e.height??"",onChange:e=>n("height",e.target.value),disabled:t}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"cm"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(P.Label,{children:"BMI (Indeks Massa Tubuh)"}),(0,a.jsx)("div",{className:"flex items-center gap-2 h-10 px-3 border rounded-md bg-muted",children:i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"font-semibold",children:i}),(0,a.jsxs)("span",{className:`text-sm ${r(parseFloat(i)).color}`,children:["(",r(parseFloat(i)).label,")"]})]}):(0,a.jsx)("span",{className:"text-muted-foreground",children:"-"})})]})]})})]})}var z=e.i(7233),F=e.i(27612),$=e.i(55436),K=e.i(88844),O=e.i(45983);let V={medicine_id:void 0,medicine_name:"",dosage:"",frequency:"",duration:"",quantity:1,instructions:""},U=["1x1","2x1","3x1","4x1","1x2","2x2","3x2","Jika perlu"],G=["3 hari","5 hari","7 hari","10 hari","14 hari","1 bulan"];function J({items:e,onChange:s,disabled:t}){let n=()=>{s([...e,{...V}])},i=a=>{s(e.filter((e,s)=>s!==a))},r=(a,t)=>{let n=[...e];n[a]={...n[a],...t},s(n)};return(0,a.jsxs)(p.Card,{children:[(0,a.jsx)(p.CardHeader,{className:"pb-4",children:(0,a.jsxs)(p.CardTitle,{className:"text-lg flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[(0,a.jsx)(_.Pill,{className:"h-5 w-5 text-green-500"}),"Resep Obat"]}),(0,a.jsxs)(h.Button,{type:"button",size:"sm",variant:"outline",onClick:n,disabled:t,children:[(0,a.jsx)(z.Plus,{className:"h-4 w-4 mr-1"}),"Tambah Obat"]})]})}),(0,a.jsx)(p.CardContent,{className:"space-y-4",children:0===e.length?(0,a.jsxs)("div",{className:"text-center py-8 text-muted-foreground border-2 border-dashed rounded-lg",children:[(0,a.jsx)(_.Pill,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),(0,a.jsx)("p",{children:"Belum ada obat ditambahkan"}),(0,a.jsx)(h.Button,{type:"button",variant:"link",onClick:n,disabled:t,children:"+ Tambah Obat"})]}):e.map((e,s)=>(0,a.jsx)(Z,{item:e,index:s,disabled:t,onUpdate:r,onRemove:i},s))})]})}function Z({item:e,index:t,disabled:n,onUpdate:i,onRemove:r}){let[l,d]=(0,s.useState)(e.medicine_name),[c,o]=(0,s.useState)([]),[m,u]=(0,s.useState)(!1),[x,p]=(0,s.useState)(!1),g=(0,s.useRef)(null);(0,s.useEffect)(()=>{d(e.medicine_name)},[e.medicine_name]),(0,s.useEffect)(()=>{if(l.length<2)return void o([]);let e=setTimeout(async()=>{u(!0);try{let e=await O.medicineService.getActiveMedicines({search:l});o(e.data||[])}catch(e){console.error("Error searching medicines:",e),o([])}finally{u(!1)}},300);return()=>clearTimeout(e)},[l]),(0,s.useEffect)(()=>{let e=e=>{g.current&&!g.current.contains(e.target)&&p(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let v=(e,a)=>{i(t,{[e]:a})};return(0,a.jsxs)("div",{className:"p-4 border rounded-lg space-y-3 relative",children:[(0,a.jsx)(h.Button,{type:"button",size:"icon",variant:"ghost",className:"absolute top-2 right-2 h-8 w-8 text-red-500 hover:text-red-700",onClick:()=>r(t),disabled:n,children:(0,a.jsx)(F.Trash2,{className:"h-4 w-4"})}),(0,a.jsxs)("div",{className:"pr-10",children:[(0,a.jsx)(P.Label,{children:"Nama Obat *"}),(0,a.jsxs)("div",{className:"relative",ref:g,children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)($.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground z-10"}),(0,a.jsx)(I.Input,{type:"text",placeholder:"Ketik untuk mencari obat...",className:"pl-10",value:l,onChange:e=>{let a=e.target.value;d(a),p(!0),i(t,{medicine_name:a,medicine_id:void 0,stock:void 0,unit:void 0})},onFocus:()=>p(!0),disabled:n,autoComplete:"off"}),m&&(0,a.jsx)(T.Loader2,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 animate-spin text-muted-foreground"})]}),x&&l.length>=2&&(0,a.jsx)("div",{className:"absolute z-50 w-full mt-1 bg-popover border rounded-md shadow-lg max-h-60 overflow-y-auto",children:m?(0,a.jsxs)("div",{className:"px-3 py-4 text-center text-sm text-muted-foreground",children:[(0,a.jsx)(T.Loader2,{className:"h-4 w-4 animate-spin mx-auto mb-2"}),"Mencari obat..."]}):c.length>0?c.map(e=>(0,a.jsx)("div",{className:"px-3 py-2 hover:bg-muted cursor-pointer border-b last:border-b-0",onClick:()=>{d(e.name),p(!1),o([]),i(t,{medicine_id:e.id,medicine_name:e.name,dosage:e.unit||"",stock:e.current_stock,unit:e.unit})},children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(K.Package,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-sm",children:e.name}),e.generic_name&&(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e.generic_name})]})]}),(0,a.jsx)("div",{className:"text-right flex-shrink-0",children:(0,a.jsxs)(j.Badge,{variant:"outline",className:e.current_stock>e.min_stock?"text-green-600 border-green-600":e.current_stock>0?"text-yellow-600 border-yellow-600":"text-red-600 border-red-600",children:["Stok: ",e.current_stock," ",e.unit]})})]})},e.id)):(0,a.jsxs)("div",{className:"px-3 py-4 text-center text-sm text-muted-foreground",children:['Tidak ditemukan obat dengan kata kunci "',l,'"']})})]}),e.medicine_id&&void 0!==e.stock&&(0,a.jsx)("div",{className:"mt-2 flex items-center gap-2",children:(0,a.jsxs)(j.Badge,{variant:"secondary",className:"text-xs",children:[(0,a.jsx)(K.Package,{className:"h-3 w-3 mr-1"}),"Stok tersedia: ",e.stock," ",e.unit]})})]}),(0,a.jsxs)("div",{className:"grid gap-3 sm:grid-cols-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(P.Label,{children:"Dosis"}),(0,a.jsx)(I.Input,{type:"text",placeholder:"500mg",value:e.dosage,onChange:e=>v("dosage",e.target.value),disabled:n})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(P.Label,{children:"Frekuensi"}),(0,a.jsx)(I.Input,{type:"text",placeholder:"3x1",value:e.frequency,onChange:e=>v("frequency",e.target.value),disabled:n,list:`freq-${t}`}),(0,a.jsx)("datalist",{id:`freq-${t}`,children:U.map(e=>(0,a.jsx)("option",{value:e},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(P.Label,{children:"Durasi"}),(0,a.jsx)(I.Input,{type:"text",placeholder:"5 hari",value:e.duration,onChange:e=>v("duration",e.target.value),disabled:n,list:`dur-${t}`}),(0,a.jsx)("datalist",{id:`dur-${t}`,children:G.map(e=>(0,a.jsx)("option",{value:e},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(P.Label,{children:"Jumlah"}),(0,a.jsx)(I.Input,{type:"number",min:"1",placeholder:"10",value:e.quantity,onChange:e=>v("quantity",parseInt(e.target.value)||1),disabled:n})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(P.Label,{children:"Aturan Pakai / Instruksi"}),(0,a.jsx)(I.Input,{type:"text",placeholder:"Contoh: Setelah makan",value:e.instructions,onChange:e=>v("instructions",e.target.value),disabled:n})]})]})}var W=e.i(70481);function Q({items:e,onChange:t,departmentId:n}){let[i,r]=(0,s.useState)([]),[l,d]=(0,s.useState)(!1),[c,o]=(0,s.useState)(null),[m,u]=(0,s.useState)(""),x=(0,s.useRef)(null);(0,s.useEffect)(()=>{(async()=>{d(!0);try{let e=await W.default.getActiveServices({department_id:n});r(e.data)}catch(e){console.error("Error fetching services:",e)}finally{d(!1)}})()},[n]),(0,s.useEffect)(()=>{let e=e=>{x.current&&!x.current.contains(e.target)&&(o(null),u(""))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let g=(a,s,n)=>{let i=[...e];i[a]={...i[a],[s]:n},t(i)},v=i.filter(e=>e.name.toLowerCase().includes(m.toLowerCase())||e.code.toLowerCase().includes(m.toLowerCase())),b=e=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(e),y=e.reduce((e,a)=>e+a.quantity*a.unit_price,0);return(0,a.jsxs)(p.Card,{children:[(0,a.jsx)(p.CardHeader,{className:"pb-3",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(p.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,a.jsx)(K.Package,{className:"h-5 w-5"}),"Layanan / Tindakan"]}),(0,a.jsxs)(h.Button,{type:"button",size:"sm",onClick:()=>{t([...e,{service_name:"",quantity:1,unit_price:0}])},children:[(0,a.jsx)(z.Plus,{className:"h-4 w-4 mr-1"}),"Tambah Layanan"]})]})}),(0,a.jsx)(p.CardContent,{className:"space-y-4",children:0===e.length?(0,a.jsxs)("div",{className:"text-center py-8 text-muted-foreground border-2 border-dashed rounded-lg",children:[(0,a.jsx)(K.Package,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),(0,a.jsx)("p",{children:"Belum ada layanan ditambahkan"}),(0,a.jsx)("p",{className:"text-sm",children:'Klik tombol "Tambah Layanan" untuk menambahkan'})]}):(0,a.jsxs)("div",{className:"space-y-3",children:[e.map((s,n)=>(0,a.jsxs)("div",{className:"p-4 rounded-lg border bg-muted/30 space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsxs)("div",{className:"flex-1 relative",ref:c===n?x:null,children:[(0,a.jsx)(P.Label,{className:"text-xs text-muted-foreground mb-1 block",children:"Nama Layanan"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(I.Input,{placeholder:"Cari atau ketik nama layanan...",value:c===n?m:s.service_name,onChange:e=>{c===n?u(e.target.value):(g(n,"service_name",e.target.value),g(n,"service_id",void 0))},onFocus:()=>{o(n),u(s.service_name)},className:"h-10 pr-10"}),(0,a.jsx)($.Search,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"})]}),c===n&&(0,a.jsxs)("div",{className:"absolute z-50 w-full mt-1 bg-popover border rounded-lg shadow-lg max-h-[300px] overflow-y-auto",children:[l?(0,a.jsx)("div",{className:"flex items-center justify-center py-6",children:(0,a.jsx)(T.Loader2,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):0===v.length?(0,a.jsxs)("div",{className:"py-4 px-3 text-center text-sm text-muted-foreground",children:[(0,a.jsx)("p",{children:"Layanan tidak ditemukan"}),(0,a.jsx)("p",{className:"text-xs mt-1",children:"Tekan Enter untuk gunakan input manual"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"px-3 py-2 text-xs font-medium text-muted-foreground border-b bg-muted/50",children:"Pilih dari daftar layanan"}),v.map(s=>(0,a.jsxs)("button",{type:"button",className:"w-full px-3 py-2 text-left hover:bg-muted/50 flex items-center justify-between border-b last:border-b-0 transition-colors",onClick:()=>{let a;(a=[...e])[n]={service_id:s.id,service_name:s.name,quantity:1,unit_price:s.total_price},t(a),o(null),u("")},children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-sm",children:s.name}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[s.code," - ",s.category_label]})]}),(0,a.jsx)(j.Badge,{variant:"secondary",className:"ml-2",children:b(s.total_price)})]},s.id))]}),m&&(0,a.jsxs)("button",{type:"button",className:"w-full px-3 py-2 text-left hover:bg-primary/10 flex items-center gap-2 border-t bg-muted/30",onClick:()=>{g(n,"service_name",m),g(n,"service_id",void 0),o(null),u("")},children:[(0,a.jsx)(z.Plus,{className:"h-4 w-4 text-primary"}),(0,a.jsxs)("span",{className:"text-sm",children:["Gunakan: ",(0,a.jsxs)("strong",{children:['"',m,'"']})]})]})]})]}),(0,a.jsxs)("div",{className:"w-24",children:[(0,a.jsx)(P.Label,{className:"text-xs text-muted-foreground mb-1 block",children:"Jumlah"}),(0,a.jsx)(I.Input,{type:"number",min:1,value:s.quantity,onChange:e=>g(n,"quantity",parseInt(e.target.value)||1),className:"h-10"})]}),(0,a.jsxs)("div",{className:"w-36",children:[(0,a.jsx)(P.Label,{className:"text-xs text-muted-foreground mb-1 block",children:"Harga Satuan"}),(0,a.jsx)(I.Input,{type:"number",min:0,value:s.unit_price,onChange:e=>g(n,"unit_price",parseFloat(e.target.value)||0),className:"h-10"})]}),(0,a.jsx)("div",{className:"pt-6",children:(0,a.jsx)(h.Button,{type:"button",size:"icon",variant:"ghost",className:"h-10 w-10 text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>{t(e.filter((e,a)=>a!==n))},children:(0,a.jsx)(F.Trash2,{className:"h-4 w-4"})})})]}),(0,a.jsx)("div",{className:"flex justify-end pt-2 border-t",children:(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("span",{className:"text-sm text-muted-foreground mr-2",children:"Subtotal:"}),(0,a.jsx)("span",{className:"font-semibold",children:b(s.quantity*s.unit_price)})]})})]},n)),e.length>0&&(0,a.jsx)("div",{className:"flex justify-end p-4 rounded-lg bg-primary/5 border border-primary/20",children:(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("span",{className:"text-muted-foreground mr-3",children:"Total Layanan:"}),(0,a.jsx)("span",{className:"text-xl font-bold text-primary",children:b(y)})]})})]})})]})}var X=e.i(52571);let Y=(0,w.default)("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),ee=(0,w.default)("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);var ea=e.i(46798),es=e.i(46696);function et({label:e,placeholder:t,value:n,onChange:i,rows:r=4,badgeLetter:l,badgeColor:d,description:c,isRecordingActive:o=!1,onRecordingStart:m,onRecordingStop:u}){let{isListening:x,isSupported:p,transcript:g,startListening:j,stopListening:v}=function(e={}){let{lang:a="id-ID",continuous:t=!0,interimResults:n=!0,onResult:i,onError:r}=e,[l,d]=(0,s.useState)(!1),[c,o]=(0,s.useState)(""),[m,u]=(0,s.useState)(null),[x,h]=(0,s.useState)(!1),p=(0,s.useRef)(null),g=(0,s.useRef)(i),j=(0,s.useRef)(r);(0,s.useEffect)(()=>{g.current=i,j.current=r},[i,r]),(0,s.useEffect)(()=>{h(!!(window.SpeechRecognition||window.webkitSpeechRecognition))},[]);let v=(0,s.useCallback)(()=>{let e=window.SpeechRecognition||window.webkitSpeechRecognition;if(!e)return void u("Browser tidak mendukung fitur voice input");p.current&&p.current.stop();let s=new e;s.lang=a,s.continuous=t,s.interimResults=n,s.onstart=()=>{d(!0),u(null),o("")},s.onresult=e=>{let a="",s="";for(let t=e.resultIndex;t<e.results.length;t++){let n=e.results[t];n.isFinal?s+=n[0].transcript:a+=n[0].transcript}a&&(o(a),g.current?.(a,!1)),s&&(o(""),g.current?.(s,!0))},s.onerror=e=>{let a={"not-allowed":"Izin mikrofon ditolak. Silakan izinkan akses mikrofon di pengaturan browser.","no-speech":"Tidak ada suara terdeteksi. Silakan coba lagi.",network:"Terjadi masalah jaringan untuk speech recognition.","audio-capture":"Mikrofon tidak ditemukan. Pastikan mikrofon terhubung.",aborted:"Perekaman suara dibatalkan."}[e.error]||`Error: ${e.error}`;u(a),d(!1),j.current?.(a)},s.onend=()=>{d(!1)},p.current=s,s.start()},[a,t,n]),b=(0,s.useCallback)(()=>{p.current&&(p.current.stop(),p.current=null),d(!1)},[]);return(0,s.useEffect)(()=>()=>{p.current&&(p.current.stop(),p.current=null)},[]),{isListening:l,isSupported:x,transcript:c,startListening:v,stopListening:b,error:m}}({lang:"id-ID",onResult:(0,s.useCallback)((e,a)=>{a&&i(n+(n?" ":"")+e)},[n,i]),onError:(0,s.useCallback)(e=>{es.toast.error("Voice Input Error",{description:e})},[])});return(0,s.useEffect)(()=>{!1===o&&x&&v()},[o,x,v]),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:`inline-flex h-7 w-7 items-center justify-center rounded-md text-sm font-bold text-white ${d}`,children:l}),(0,a.jsx)(P.Label,{className:"text-sm font-semibold",children:e})]}),c&&(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:c}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(L.Textarea,{placeholder:t,value:n,onChange:e=>i(e.target.value),rows:r,className:"pr-12"}),(0,a.jsx)("div",{className:"absolute bottom-2 right-2",children:(0,a.jsx)(ea.TooltipProvider,{children:(0,a.jsxs)(ea.Tooltip,{children:[(0,a.jsx)(ea.TooltipTrigger,{asChild:!0,children:(0,a.jsx)(h.Button,{type:"button",variant:x?"destructive":"outline",size:"icon",className:`h-8 w-8 ${x?"animate-pulse-ring bg-red-500 hover:bg-red-600 text-white":""}`,onClick:()=>{x?(v(),u?.()):(j(),m?.())},disabled:!p,children:x?(0,a.jsx)(ee,{className:"h-4 w-4"}):(0,a.jsx)(Y,{className:"h-4 w-4"})})}),(0,a.jsx)(ea.TooltipContent,{children:p?x?"Klik untuk berhenti rekam":"Klik untuk mulai rekam suara":"Browser tidak mendukung voice input. Gunakan Google Chrome."})]})})})]}),x&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs text-red-500",children:[(0,a.jsxs)("span",{className:"relative flex h-2 w-2",children:[(0,a.jsx)("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-red-400 opacity-75"}),(0,a.jsx)("span",{className:"relative inline-flex h-2 w-2 rounded-full bg-red-500"})]}),(0,a.jsxs)("span",{children:["Sedang mendengarkan..."," ",g&&(0,a.jsx)("span",{className:"italic text-muted-foreground",children:g})]})]})]})}function en({values:e,onChange:t}){let[n,i]=(0,s.useState)(null),r=(0,s.useCallback)(e=>{i(e)},[]),l=(0,s.useCallback)(()=>{i(null)},[]);return(0,a.jsxs)(p.Card,{children:[(0,a.jsxs)(p.CardHeader,{children:[(0,a.jsx)(p.CardTitle,{className:"text-lg",children:"CPPT - Catatan Perkembangan Pasien Terintegrasi"}),(0,a.jsxs)("div",{className:"flex items-start gap-2 rounded-md bg-blue-50 p-3 text-sm text-blue-700 dark:bg-blue-950/30 dark:text-blue-300",children:[(0,a.jsx)(X.Info,{className:"mt-0.5 h-4 w-4 shrink-0"}),(0,a.jsx)("p",{children:"CPPT merupakan catatan perkembangan terintegrasi dalam format SOAP yang digunakan untuk mendokumentasikan perkembangan kondisi pasien. Anda dapat mengetik langsung atau menggunakan tombol mikrofon untuk input suara."})]})]}),(0,a.jsxs)(p.CardContent,{className:"space-y-6",children:[(0,a.jsx)(et,{badgeLetter:"S",badgeColor:"bg-blue-500",label:"Subjective",description:"Keluhan dan gejala yang disampaikan pasien, riwayat perjalanan penyakit",placeholder:"Keluhan pasien, gejala yang dirasakan, riwayat yang disampaikan pasien...",value:e.soap_subjective,onChange:e=>t("soap_subjective",e),rows:4,isRecordingActive:"soap_subjective"===n,onRecordingStart:()=>r("soap_subjective"),onRecordingStop:l}),(0,a.jsx)(et,{badgeLetter:"O",badgeColor:"bg-green-500",label:"Objective",description:"Hasil pemeriksaan fisik, tanda vital, hasil laboratorium dan penunjang",placeholder:"Hasil pemeriksaan fisik, tanda vital, hasil laboratorium, hasil penunjang...",value:e.soap_objective,onChange:e=>t("soap_objective",e),rows:4,isRecordingActive:"soap_objective"===n,onRecordingStart:()=>r("soap_objective"),onRecordingStop:l}),(0,a.jsx)(et,{badgeLetter:"A",badgeColor:"bg-orange-500",label:"Assessment",description:"Diagnosis, diagnosis banding, dan penilaian klinis",placeholder:"Diagnosis, diagnosis banding, penilaian klinis...",value:e.soap_assessment,onChange:e=>t("soap_assessment",e),rows:3,isRecordingActive:"soap_assessment"===n,onRecordingStart:()=>r("soap_assessment"),onRecordingStop:l}),(0,a.jsx)(et,{badgeLetter:"P",badgeColor:"bg-purple-500",label:"Plan",description:"Rencana terapi, tindakan medis, edukasi pasien, dan rencana kontrol",placeholder:"Rencana terapi, tindakan, edukasi, rencana kontrol...",value:e.soap_plan,onChange:e=>t("soap_plan",e),rows:3,isRecordingActive:"soap_plan"===n,onRecordingStart:()=>r("soap_plan"),onRecordingStop:l})]})]})}var ei=e.i(29325);function er({medicalRecord:e,queue:i,onClose:r,onUpdate:d}){let[c,u]=(0,s.useState)(!1),[x,g]=(0,s.useState)(!1),[w,R]=(0,s.useState)("anamnesis"),[M,E]=(0,s.useState)({chief_complaint:e.chief_complaint||"",present_illness:e.present_illness||"",past_medical_history:e.past_medical_history||"",family_history:e.family_history||"",allergy_notes:e.allergy_notes||"",blood_pressure_systolic:e.blood_pressure_systolic,blood_pressure_diastolic:e.blood_pressure_diastolic,heart_rate:e.heart_rate,respiratory_rate:e.respiratory_rate,temperature:e.temperature,weight:e.weight,height:e.height,oxygen_saturation:e.oxygen_saturation,physical_examination:e.physical_examination||"",diagnosis:e.diagnosis||"",diagnosis_notes:e.diagnosis_notes||"",treatment:e.treatment||"",treatment_notes:e.treatment_notes||"",recommendations:e.recommendations||"",follow_up_date:e.follow_up_date||"",soap_subjective:e.soap_subjective||"",soap_objective:e.soap_objective||"",soap_assessment:e.soap_assessment||"",soap_plan:e.soap_plan||""}),[q,A]=(0,s.useState)([]),[D,z]=(0,s.useState)([]);(0,s.useEffect)(()=>{e.prescriptions&&e.prescriptions.length>0&&A(e.prescriptions.flatMap(e=>(e.items||[]).map(e=>({medicine_name:e.medicine_name,dosage:e.dosage||"",frequency:e.frequency||"",duration:e.duration||"",quantity:e.quantity,instructions:e.instructions||""}))))},[e.prescriptions]),(0,s.useEffect)(()=>{e.services&&e.services.length>0&&z(e.services.map(e=>({service_id:e.service_id??void 0,service_name:e.service_name,quantity:e.quantity,unit_price:e.unit_price})))},[e.services]);let F=(e,a)=>{E(s=>({...s,[e]:a}))},$=async()=>{g(!0);try{let a={...M,services:D.map(e=>({service_name:e.service_name,quantity:e.quantity,unit_price:e.unit_price}))},s=await ei.default.updateMedicalRecord(e.id,a);d(s.data),q.length>0&&q.some(e=>e.medicine_name)&&await ei.default.addPrescription(e.id,{items:q.filter(e=>e.medicine_name)}),es.toast.success("Data berhasil disimpan",{description:"Data pemeriksaan telah tersimpan"})}catch(e){console.error("Error saving:",e),es.toast.error("Gagal menyimpan data",{description:e.response?.data?.message||"Terjadi kesalahan"})}finally{g(!1)}},K=async()=>{if(confirm("Apakah Anda yakin ingin menyelesaikan pemeriksaan ini?")){u(!0);try{await $(),await ei.default.completeExamination(e.id,!0),es.toast.success("Pemeriksaan selesai",{description:"Invoice telah dibuat dan pasien dapat melanjutkan ke kasir"}),r()}catch(e){console.error("Error completing:",e),es.toast.error("Gagal menyelesaikan pemeriksaan",{description:e.response?.data?.message||"Terjadi kesalahan"})}finally{u(!1)}}},O=e.patient;return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(t.motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(h.Button,{variant:"ghost",size:"icon",onClick:r,children:(0,a.jsx)(b.ArrowLeft,{className:"h-5 w-5"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold tracking-tight",children:"Form Pemeriksaan"}),(0,a.jsxs)("p",{className:"text-muted-foreground",children:[e.record_number," - ",i?.queue_code]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(h.Button,{variant:"outline",onClick:$,disabled:x,children:[x?(0,a.jsx)(T.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}):(0,a.jsx)(y.Save,{className:"h-4 w-4 mr-2"}),"Simpan"]}),(0,a.jsxs)(h.Button,{onClick:K,disabled:c,children:[c?(0,a.jsx)(T.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}):(0,a.jsx)(l.CheckCircle,{className:"h-4 w-4 mr-2"}),"Selesai Periksa"]})]})]}),(0,a.jsx)(t.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},children:(0,a.jsx)(p.Card,{children:(0,a.jsxs)(p.CardContent,{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4",children:[(0,a.jsx)("div",{className:"p-3 rounded-full bg-primary/10",children:(0,a.jsx)(f.User,{className:"h-8 w-8 text-primary"})}),(0,a.jsxs)("div",{className:"flex-1 grid gap-2 sm:grid-cols-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Nama Pasien"}),(0,a.jsx)("p",{className:"font-semibold",children:O?.name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"No. RM"}),(0,a.jsx)("p",{className:"font-medium",children:O?.medical_record_number})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Umur / Jenis Kelamin"}),(0,a.jsxs)("p",{className:"font-medium",children:[O?.age," tahun / ",O?.gender_label]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Tipe Pasien"}),(0,a.jsx)(j.Badge,{variant:O?.patient_type==="bpjs"?"success":"secondary",children:O?.patient_type_label})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(j.Badge,{variant:"outline",children:[(0,a.jsx)(o.Building2,{className:"h-3 w-3 mr-1"}),e.department?.name]}),(0,a.jsxs)(j.Badge,{variant:"outline",children:[(0,a.jsx)(N.Calendar,{className:"h-3 w-3 mr-1"}),new Date(e.visit_date).toLocaleDateString("id-ID")]})]})]}),O?.allergies&&(0,a.jsxs)("div",{className:"mt-3 p-2 rounded bg-red-50 dark:bg-red-950/30 text-red-700 dark:text-red-300 text-sm",children:[(0,a.jsx)("strong",{children:"Alergi:"})," ",O.allergies]})]})})}),(0,a.jsx)(t.motion.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.1},children:(0,a.jsxs)(v.Tabs,{value:w,onValueChange:R,children:[(0,a.jsxs)(v.TabsList,{className:"grid w-full grid-cols-6",children:[(0,a.jsxs)(v.TabsTrigger,{value:"anamnesis",className:"gap-1",children:[(0,a.jsx)(m.ClipboardList,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Anamnesis"})]}),(0,a.jsxs)(v.TabsTrigger,{value:"vitals",className:"gap-1",children:[(0,a.jsx)(n.Stethoscope,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Vital Signs"})]}),(0,a.jsxs)(v.TabsTrigger,{value:"diagnosis",className:"gap-1",children:[(0,a.jsx)(k.FileText,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Diagnosis"})]}),(0,a.jsxs)(v.TabsTrigger,{value:"prescription",className:"gap-1",children:[(0,a.jsx)(_.Pill,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Resep"})]}),(0,a.jsxs)(v.TabsTrigger,{value:"recommendation",className:"gap-1",children:[(0,a.jsx)(C,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Anjuran"})]}),(0,a.jsxs)(v.TabsTrigger,{value:"cppt",className:"gap-1",children:[(0,a.jsx)(S,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"CPPT"})]})]}),(0,a.jsx)(v.TabsContent,{value:"anamnesis",className:"space-y-4 mt-4",children:(0,a.jsxs)(p.Card,{children:[(0,a.jsx)(p.CardHeader,{children:(0,a.jsx)(p.CardTitle,{className:"text-lg",children:"Anamnesis (Keluhan)"})}),(0,a.jsxs)(p.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(P.Label,{children:"Keluhan Utama *"}),(0,a.jsx)(L.Textarea,{placeholder:"Masukkan keluhan utama pasien...",value:M.chief_complaint||"",onChange:e=>F("chief_complaint",e.target.value),rows:3})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(P.Label,{children:"Riwayat Penyakit Sekarang"}),(0,a.jsx)(L.Textarea,{placeholder:"Ceritakan perjalanan penyakit...",value:M.present_illness||"",onChange:e=>F("present_illness",e.target.value),rows:3})]}),(0,a.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(P.Label,{children:"Riwayat Penyakit Dahulu"}),(0,a.jsx)(L.Textarea,{placeholder:"Penyakit yang pernah diderita...",value:M.past_medical_history||"",onChange:e=>F("past_medical_history",e.target.value),rows:2})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(P.Label,{children:"Riwayat Penyakit Keluarga"}),(0,a.jsx)(L.Textarea,{placeholder:"Riwayat penyakit dalam keluarga...",value:M.family_history||"",onChange:e=>F("family_history",e.target.value),rows:2})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(P.Label,{children:"Catatan Alergi"}),(0,a.jsx)(L.Textarea,{placeholder:"Alergi obat, makanan, dll...",value:M.allergy_notes||"",onChange:e=>F("allergy_notes",e.target.value),rows:2})]})]})]})}),(0,a.jsxs)(v.TabsContent,{value:"vitals",className:"space-y-4 mt-4",children:[(0,a.jsx)(H,{values:{blood_pressure_systolic:M.blood_pressure_systolic,blood_pressure_diastolic:M.blood_pressure_diastolic,heart_rate:M.heart_rate,respiratory_rate:M.respiratory_rate,temperature:M.temperature,weight:M.weight,height:M.height,oxygen_saturation:M.oxygen_saturation},onChange:(e,a)=>{E(s=>({...s,[e]:a}))}}),(0,a.jsxs)(p.Card,{children:[(0,a.jsx)(p.CardHeader,{children:(0,a.jsx)(p.CardTitle,{className:"text-lg",children:"Pemeriksaan Fisik"})}),(0,a.jsx)(p.CardContent,{children:(0,a.jsx)(L.Textarea,{placeholder:"Hasil pemeriksaan fisik...",value:M.physical_examination||"",onChange:e=>F("physical_examination",e.target.value),rows:4})})]})]}),(0,a.jsxs)(v.TabsContent,{value:"diagnosis",className:"space-y-4 mt-4",children:[(0,a.jsxs)(p.Card,{children:[(0,a.jsx)(p.CardHeader,{children:(0,a.jsx)(p.CardTitle,{className:"text-lg",children:"Diagnosis & Tindakan"})}),(0,a.jsxs)(p.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(P.Label,{children:"Diagnosis *"}),(0,a.jsx)(L.Textarea,{placeholder:"Masukkan diagnosis...",value:M.diagnosis||"",onChange:e=>F("diagnosis",e.target.value),rows:3})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(P.Label,{children:"Catatan Diagnosis"}),(0,a.jsx)(L.Textarea,{placeholder:"Catatan tambahan untuk diagnosis...",value:M.diagnosis_notes||"",onChange:e=>F("diagnosis_notes",e.target.value),rows:2})]}),(0,a.jsx)(B.Separator,{}),(0,a.jsxs)("div",{children:[(0,a.jsx)(P.Label,{children:"Tindakan / Treatment"}),(0,a.jsx)(L.Textarea,{placeholder:"Tindakan yang dilakukan...",value:M.treatment||"",onChange:e=>F("treatment",e.target.value),rows:3})]})]})]}),(0,a.jsx)(Q,{items:D,onChange:z,departmentId:e.department_id})]}),(0,a.jsx)(v.TabsContent,{value:"prescription",className:"mt-4",children:(0,a.jsx)(J,{items:q,onChange:A})}),(0,a.jsx)(v.TabsContent,{value:"recommendation",className:"space-y-4 mt-4",children:(0,a.jsxs)(p.Card,{children:[(0,a.jsx)(p.CardHeader,{children:(0,a.jsx)(p.CardTitle,{className:"text-lg",children:"Anjuran & Kontrol"})}),(0,a.jsxs)(p.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(P.Label,{children:"Anjuran untuk Pasien"}),(0,a.jsx)(L.Textarea,{placeholder:"Anjuran, saran, dan edukasi untuk pasien...",value:M.recommendations||"",onChange:e=>F("recommendations",e.target.value),rows:4})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(P.Label,{children:"Tanggal Kontrol"}),(0,a.jsx)(I.Input,{type:"date",value:M.follow_up_date||"",onChange:e=>F("follow_up_date",e.target.value),className:"w-48"})]})]})]})}),(0,a.jsx)(v.TabsContent,{value:"cppt",className:"space-y-4 mt-4",children:(0,a.jsx)(en,{values:{soap_subjective:M.soap_subjective||"",soap_objective:M.soap_objective||"",soap_assessment:M.soap_assessment||"",soap_plan:M.soap_plan||""},onChange:(e,a)=>F(e,a)})})]})})]})}e.i(10160),e.i(76639),e.i(59684);var el=e.i(90893),ed=e.i(482);function ec(){let{user:e}=(0,ed.useAuth)(),[b,y]=(0,s.useState)([]),[f,N]=(0,s.useState)([]),[k,_]=(0,s.useState)([]),[w,C]=(0,s.useState)(null),[T,S]=(0,s.useState)([]),[L,P]=(0,s.useState)("all"),[I,B]=(0,s.useState)(!0),[R,M]=(0,s.useState)(!1),[E,q]=(0,s.useState)("active"),[A,D]=(0,s.useState)(null),[H,z]=(0,s.useState)(null),F=e?.role==="dokter",$=e?.departments||[],K=$.length>0,O=(0,s.useCallback)(async()=>{try{let e="all"!==L?parseInt(L):void 0,a=await ei.default.getPendingExaminations(e);y(a.data.waiting),N(a.data.in_progress)}catch(e){console.error("Error fetching pending examinations:",e)}},[L]),V=(0,s.useCallback)(async()=>{try{let e="all"!==L?parseInt(L):void 0,a=await ei.default.getExaminationStats(void 0,e);C(a.data)}catch(e){console.error("Error fetching stats:",e)}},[L]),U=(0,s.useCallback)(async()=>{try{let e="all"!==L?parseInt(L):void 0,a=await ei.default.getCompletedExaminations(e);_(a.data)}catch(e){console.error("Error fetching completed examinations:",e)}},[L]),G=(0,s.useCallback)(async()=>{try{let e=await el.default.getActiveDepartments();if(F&&K){let a=$.map(e=>e.id),s=e.data.filter(e=>a.includes(e.id));S(s);let t=$.find(e=>e.is_primary);t?P(t.id.toString()):s.length>0&&P(s[0].id.toString())}else S(e.data)}catch(e){console.error("Error fetching departments:",e)}},[F,K,$]);(0,s.useEffect)(()=>{(async()=>{B(!0),await Promise.all([O(),V(),G(),U()]),B(!1)})()},[O,V,G,U]),(0,s.useEffect)(()=>{let e=setInterval(()=>{O(),V(),U()},15e3);return()=>clearInterval(e)},[O,V,U]);let J=async()=>{M(!0),await Promise.all([O(),V(),U()]),M(!1)},Z=async e=>{try{let a=await ei.default.startExamination({queue_id:e.id});D(a.data),z(e),es.toast.success("Pemeriksaan dimulai",{description:`Pasien ${e.patient?.name||e.queue_code}`}),J()}catch(e){console.error("Error starting examination:",e),es.toast.error("Gagal memulai pemeriksaan",{description:e.response?.data?.message||"Terjadi kesalahan"})}},W=async e=>{try{let a=await ei.default.getMedicalRecordById(e.id);D(a.data),z(e.queue||null)}catch(e){console.error("Error loading examination:",e),es.toast.error("Gagal memuat data pemeriksaan",{description:e.response?.data?.message||"Terjadi kesalahan"})}},Q=[{title:"Menunggu Diperiksa",value:w?.waiting||0,icon:r.Clock,color:"yellow"},{title:"Sedang Diperiksa",value:w?.in_progress||0,icon:n.Stethoscope,color:"blue"},{title:"Selesai Hari Ini",value:w?.completed||0,icon:l.CheckCircle,color:"green"},{title:"Rata-rata Waktu",value:w?.avg_exam_time?`${w.avg_exam_time} mnt`:"-",icon:c.Timer,color:"purple"}],X={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};return A?(0,a.jsx)(er,{medicalRecord:A,queue:H,onClose:()=>{D(null),z(null),J()},onUpdate:e=>D(e)}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(t.motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold tracking-tight",children:"Pemeriksaan Pasien"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:F&&K?`Poli: ${$.map(e=>e.name).join(", ")}`:"Layanan pemeriksaan pasien hari ini"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(g.Select,{value:L,onValueChange:P,children:[(0,a.jsxs)(g.SelectTrigger,{className:"w-[200px]",children:[(0,a.jsx)(o.Building2,{className:"mr-2 h-4 w-4"}),(0,a.jsx)(g.SelectValue,{placeholder:"Semua Poli"})]}),(0,a.jsxs)(g.SelectContent,{children:[(!F||T.length>1)&&(0,a.jsx)(g.SelectItem,{value:"all",children:"Semua Poli"}),T.map(e=>(0,a.jsx)(g.SelectItem,{value:e.id.toString(),children:e.name},e.id))]})]}),(0,a.jsx)(h.Button,{variant:"outline",size:"icon",onClick:J,disabled:R,children:(0,a.jsx)(i.RefreshCw,{className:`h-4 w-4 ${R?"animate-spin":""}`})})]})]}),(0,a.jsx)(t.motion.div,{variants:{hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},initial:"hidden",animate:"show",className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:Q.map(e=>(0,a.jsx)(t.motion.div,{variants:X,children:(0,a.jsx)(p.Card,{children:(0,a.jsx)(p.CardContent,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:e.title}),(0,a.jsx)("p",{className:"text-3xl font-bold mt-2",children:I?"-":e.value})]}),(0,a.jsx)("div",{className:`p-3 rounded-xl bg-${e.color}-100 dark:bg-${e.color}-950`,children:(0,a.jsx)(e.icon,{className:`h-6 w-6 text-${e.color}-600 dark:text-${e.color}-400`})})]})})})},e.title))}),(0,a.jsxs)(v.Tabs,{value:E,onValueChange:e=>q(e),children:[(0,a.jsxs)(v.TabsList,{children:[(0,a.jsxs)(v.TabsTrigger,{value:"active",children:["Aktif (",b.length+f.length,")"]}),(0,a.jsxs)(v.TabsTrigger,{value:"completed",children:["Selesai Hari Ini (",k.length,")"]})]}),(0,a.jsx)(v.TabsContent,{value:"active",className:"mt-4",children:(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,a.jsx)(t.motion.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:(0,a.jsxs)(p.Card,{children:[(0,a.jsx)(p.CardHeader,{className:"pb-3",children:(0,a.jsxs)(p.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"p-2 rounded-lg bg-blue-100 dark:bg-blue-950",children:(0,a.jsx)(n.Stethoscope,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"})}),"Sedang Diperiksa",f.length>0&&(0,a.jsx)(j.Badge,{variant:"secondary",children:f.length})]})}),(0,a.jsx)(p.CardContent,{className:"space-y-3",children:0===f.length?(0,a.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,a.jsx)(m.ClipboardList,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),(0,a.jsx)("p",{children:"Belum ada pemeriksaan aktif"})]}):f.map(e=>(0,a.jsxs)("div",{className:"p-4 rounded-lg border bg-blue-50 dark:bg-blue-950/30 hover:border-blue-300 transition-colors cursor-pointer",onClick:()=>W(e),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 rounded-full bg-blue-100 dark:bg-blue-900",children:(0,a.jsx)(x.UserCheck,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold",children:e.patient?.name}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.queue?.queue_code," -"," ",e.patient?.medical_record_number]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)(j.Badge,{variant:"info",children:e.department?.name}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[e.patient?.age," tahun,"," ",e.patient?.gender_label]})]})]}),(0,a.jsxs)("div",{className:"mt-3 flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Mulai:"," ",new Date(e.created_at).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"})]}),(0,a.jsxs)(h.Button,{size:"sm",variant:"outline",children:[(0,a.jsx)(u.PlayCircle,{className:"h-4 w-4 mr-1"}),"Lanjutkan"]})]})]},e.id))})]})}),(0,a.jsx)(t.motion.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},children:(0,a.jsxs)(p.Card,{children:[(0,a.jsx)(p.CardHeader,{className:"pb-3",children:(0,a.jsxs)(p.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"p-2 rounded-lg bg-yellow-100 dark:bg-yellow-950",children:(0,a.jsx)(r.Clock,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-400"})}),"Antrian Menunggu Diperiksa",b.length>0&&(0,a.jsx)(j.Badge,{variant:"secondary",children:b.length})]})}),(0,a.jsx)(p.CardContent,{className:"space-y-3 max-h-[500px] overflow-y-auto",children:0===b.length?(0,a.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,a.jsx)(d.Users,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),(0,a.jsx)("p",{children:"Tidak ada pasien menunggu"})]}):b.map(e=>(0,a.jsxs)("div",{className:"p-4 rounded-lg border hover:border-primary transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 rounded-full bg-yellow-100 dark:bg-yellow-900",children:(0,a.jsx)(d.Users,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold",children:e.patient?.name||"Pasien"}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.queue_code," -"," ",e.patient?.medical_record_number||"-"]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)(j.Badge,{children:e.department?.name}),e.patient&&(0,a.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[e.patient.age," tahun,"," ",e.patient.gender_label]})]})]}),(0,a.jsxs)("div",{className:"mt-3 flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Tunggu: ",e.wait_time," menit"]}),(0,a.jsxs)(h.Button,{size:"sm",onClick:()=>Z(e),children:[(0,a.jsx)(n.Stethoscope,{className:"h-4 w-4 mr-1"}),"Periksa"]})]})]},e.id))})]})})]})}),(0,a.jsx)(v.TabsContent,{value:"completed",className:"mt-4",children:(0,a.jsxs)(p.Card,{children:[(0,a.jsx)(p.CardHeader,{className:"pb-3",children:(0,a.jsxs)(p.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"p-2 rounded-lg bg-green-100 dark:bg-green-950",children:(0,a.jsx)(l.CheckCircle,{className:"h-4 w-4 text-green-600 dark:text-green-400"})}),"Pasien Selesai Diperiksa Hari Ini"]})}),(0,a.jsx)(p.CardContent,{children:0===k.length?(0,a.jsxs)("div",{className:"text-center py-12 text-muted-foreground",children:[(0,a.jsx)(l.CheckCircle,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),(0,a.jsx)("p",{children:"Belum ada pasien selesai diperiksa hari ini"})]}):(0,a.jsx)("div",{className:"space-y-3",children:k.map(e=>(0,a.jsxs)("div",{className:"p-4 rounded-lg border bg-green-50 dark:bg-green-950/30",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 rounded-full bg-green-100 dark:bg-green-900",children:(0,a.jsx)(l.CheckCircle,{className:"h-4 w-4 text-green-600 dark:text-green-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold",children:e.patient?.name}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.queue?.queue_code," -"," ",e.patient?.medical_record_number]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)(j.Badge,{variant:"success",children:e.department?.name}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[e.patient?.age," tahun,"," ",e.patient?.gender_label]})]})]}),(0,a.jsxs)("div",{className:"mt-3 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:[(0,a.jsxs)("span",{children:["Selesai:"," ",e.completed_at?new Date(e.completed_at).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}):"-"]}),(0,a.jsx)("span",{className:"mx-2",children:"|"}),(0,a.jsxs)("span",{children:["Dokter: ",e.doctor?.name||"-"]})]}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:e.invoice?(0,a.jsx)(j.Badge,{variant:"paid"===e.invoice.payment_status?"success":"warning",children:"paid"===e.invoice.payment_status?"Sudah Bayar":"Belum Bayar"}):(0,a.jsx)(j.Badge,{variant:"outline",children:"Belum Ada Invoice"})})]})]},e.id))})})]})})]})]})}e.s(["default",()=>ec],17787)}]);