module.exports=[25890,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(46271),e=a.i(66322),f=a.i(69520),g=a.i(41710),h=a.i(16201),i=a.i(1199),j=a.i(24669),k=a.i(87532),l=a.i(35126);let m=(0,a.i(70106).default)("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);var n=a.i(3858),o=a.i(83497),p=a.i(99570),q=a.i(91119),r=a.i(66718),s=a.i(86304),t=a.i(75083),u=a.i(6015);a.i(90285);var v=a.i(8033),w=a.i(13328),x=a.i(14574),y=a.i(5084),z=a.i(41572);function A(){let[a,A]=(0,c.useState)([]),[B,C]=(0,c.useState)([]),[D,E]=(0,c.useState)(null),[F,G]=(0,c.useState)(!0),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)(""),[L,M]=(0,c.useState)("pending"),[N,O]=(0,c.useState)(!1),[P,Q]=(0,c.useState)(!1),[R,S]=(0,c.useState)(null),[T,U]=(0,c.useState)(!1),[V,W]=(0,c.useState)([]),[X,Y]=(0,c.useState)(""),Z=(0,c.useCallback)(async()=>{try{let a=await z.default.getCompletedExaminations(void 0,void 0,!0),b=await z.default.getPrescriptions({date:z.default.getTodayDateString()}),c=new Map,d=new Map;b.data.forEach(a=>{if(a.medical_record_id){let b=c.get(a.medical_record_id)||0,e=a.items?.length||0;c.set(a.medical_record_id,b+e);let f=d.get(a.medical_record_id)||[];d.set(a.medical_record_id,[...f,a])}});let e=a.data.map(a=>({...a,prescription_items_count:c.get(a.id)||0,prescriptions_data:d.get(a.id)||[]}));A(e)}catch(a){console.error("Error fetching completed examinations:",a)}},[]),$=(0,c.useCallback)(async()=>{try{let a=await z.default.getInvoices({date:z.default.getTodayDateString(),payment_status:"paid"});C(a.data)}catch(a){console.error("Error fetching paid invoices:",a)}},[]),_=(0,c.useCallback)(async()=>{try{let a=await z.default.getInvoiceStats();E(a.data)}catch(a){console.error("Error fetching stats:",a)}},[]);(0,c.useEffect)(()=>{(async()=>{G(!0),await Promise.all([Z(),$(),_()]),G(!1)})()},[Z,$,_]),(0,c.useEffect)(()=>{let a=setInterval(()=>{Z(),_()},15e3);return()=>clearInterval(a)},[Z,_]);let aa=async()=>{I(!0),await Promise.all([Z(),$(),_()]),I(!1)},ab=a.filter(a=>a.patient?.name.toLowerCase().includes(J.toLowerCase())||a.patient?.medical_record_number?.toLowerCase().includes(J.toLowerCase())||a.queue?.queue_code?.toLowerCase().includes(J.toLowerCase())),ac=B.filter(a=>a.invoice_number.toLowerCase().includes(J.toLowerCase())||a.patient?.name.toLowerCase().includes(J.toLowerCase())||a.patient?.medical_record_number?.toLowerCase().includes(J.toLowerCase())),ad=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a),ae=[{title:"Menunggu Pembayaran",value:a.length,icon:l.Stethoscope,color:"yellow"},{title:"Belum Bayar",value:D?.unpaid||0,subValue:D?.total_unpaid?ad(D.total_unpaid):"-",icon:g.Clock,color:"red"},{title:"Sudah Bayar",value:D?.paid||0,icon:h.CheckCircle,color:"green"},{title:"Total Pendapatan",value:D?.total_revenue?ad(D.total_revenue):"-",icon:j.TrendingUp,color:"purple",isLarge:!0}],af={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(d.motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold tracking-tight",children:"Kasir"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Kelola pembayaran pasien"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(k.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(r.Input,{placeholder:"Cari invoice atau pasien...",value:J,onChange:a=>K(a.target.value),className:"pl-9 w-[250px]"})]}),(0,b.jsx)(p.Button,{variant:"outline",size:"icon",onClick:aa,disabled:H,children:(0,b.jsx)(f.RefreshCw,{className:`h-4 w-4 ${H?"animate-spin":""}`})})]})]}),(0,b.jsx)(d.motion.div,{variants:{hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},initial:"hidden",animate:"show",className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:ae.map(a=>(0,b.jsx)(d.motion.div,{variants:af,children:(0,b.jsx)(q.Card,{children:(0,b.jsx)(q.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:a.title}),(0,b.jsx)("p",{className:`${a.isLarge?"text-2xl":"text-3xl"} font-bold mt-2`,children:F?"-":a.value}),a.subValue&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.subValue})]}),(0,b.jsx)("div",{className:`p-3 rounded-xl bg-${a.color}-100 dark:bg-${a.color}-950`,children:(0,b.jsx)(a.icon,{className:`h-6 w-6 text-${a.color}-600 dark:text-${a.color}-400`})})]})})})},a.title))}),(0,b.jsx)(d.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:(0,b.jsxs)(q.Card,{children:[(0,b.jsx)(q.CardHeader,{children:(0,b.jsx)(q.CardTitle,{children:"Pembayaran Pasien"})}),(0,b.jsx)(q.CardContent,{children:(0,b.jsxs)(t.Tabs,{value:L,onValueChange:M,children:[(0,b.jsxs)(t.TabsList,{children:[(0,b.jsxs)(t.TabsTrigger,{value:"pending",className:"gap-2",children:[(0,b.jsx)(l.Stethoscope,{className:"h-4 w-4"}),"Menunggu Pembayaran (",a.length,")"]}),(0,b.jsxs)(t.TabsTrigger,{value:"history",className:"gap-2",children:[(0,b.jsx)(m,{className:"h-4 w-4"}),"Riwayat Hari Ini (",B.length,")"]})]}),(0,b.jsx)(t.TabsContent,{value:"pending",className:"mt-4",children:0===ab.length?(0,b.jsxs)("div",{className:"text-center py-12 text-muted-foreground",children:[(0,b.jsx)(h.CheckCircle,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),(0,b.jsx)("p",{children:"Tidak ada pasien menunggu pembayaran"})]}):(0,b.jsxs)(u.Table,{children:[(0,b.jsx)(u.TableHeader,{children:(0,b.jsxs)(u.TableRow,{children:[(0,b.jsx)(u.TableHead,{children:"No. Antrian"}),(0,b.jsx)(u.TableHead,{children:"Pasien"}),(0,b.jsx)(u.TableHead,{children:"Poli"}),(0,b.jsx)(u.TableHead,{children:"Dokter"}),(0,b.jsx)(u.TableHead,{className:"text-center",children:"Resep"}),(0,b.jsx)(u.TableHead,{className:"text-right",children:"Total"}),(0,b.jsx)(u.TableHead,{children:"Status"}),(0,b.jsx)(u.TableHead,{className:"text-right",children:"Aksi"})]})}),(0,b.jsx)(u.TableBody,{children:ab.map(a=>{let c=a.prescription_items_count||0;return(0,b.jsxs)(u.TableRow,{children:[(0,b.jsx)(u.TableCell,{className:"font-medium",children:a.queue?.queue_code||"-"}),(0,b.jsx)(u.TableCell,{children:(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.patient?.name}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.patient?.medical_record_number})]})}),(0,b.jsx)(u.TableCell,{children:(0,b.jsx)(s.Badge,{variant:"outline",children:a.department?.name||"-"})}),(0,b.jsx)(u.TableCell,{className:"text-sm",children:a.doctor?.name||"-"}),(0,b.jsx)(u.TableCell,{className:"text-center",children:c>0?(0,b.jsxs)(s.Badge,{variant:"secondary",className:"gap-1 cursor-pointer hover:bg-secondary/80 transition-colors",onClick:()=>{a.prescriptions_data&&a.prescriptions_data.length>0&&(W(a.prescriptions_data),Y(a.patient?.name||"Pasien"),U(!0))},children:[(0,b.jsx)(n.Pill,{className:"h-3 w-3"}),c," obat"]}):(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"-"})}),(0,b.jsx)(u.TableCell,{className:"text-right font-semibold",children:a.invoice?ad(a.invoice.total_amount):"-"}),(0,b.jsx)(u.TableCell,{children:a.invoice?(a=>{switch(a){case"paid":return(0,b.jsx)(s.Badge,{variant:"success",children:"Lunas"});case"partial":return(0,b.jsx)(s.Badge,{variant:"warning",children:"Sebagian"});case"unpaid":return(0,b.jsx)(s.Badge,{variant:"error",children:"Belum Bayar"});default:return(0,b.jsx)(s.Badge,{children:a})}})(a.invoice.payment_status):(0,b.jsx)(s.Badge,{variant:"outline",children:"Belum Ada Invoice"})}),(0,b.jsx)(u.TableCell,{className:"text-right",children:a.invoice?(0,b.jsxs)(p.Button,{size:"sm",onClick:()=>{a.invoice&&(S(a.invoice),O(!0))},children:[(0,b.jsx)(e.Banknote,{className:"h-4 w-4 mr-1"}),"Bayar"]}):(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"-"})})]},a.id)})})]})}),(0,b.jsx)(t.TabsContent,{value:"history",className:"mt-4",children:0===ac.length?(0,b.jsxs)("div",{className:"text-center py-12 text-muted-foreground",children:[(0,b.jsx)(i.Receipt,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),(0,b.jsx)("p",{children:"Belum ada transaksi hari ini"})]}):(0,b.jsxs)(u.Table,{children:[(0,b.jsx)(u.TableHeader,{children:(0,b.jsxs)(u.TableRow,{children:[(0,b.jsx)(u.TableHead,{children:"No. Invoice"}),(0,b.jsx)(u.TableHead,{children:"Pasien"}),(0,b.jsx)(u.TableHead,{children:"Poli"}),(0,b.jsx)(u.TableHead,{className:"text-right",children:"Total"}),(0,b.jsx)(u.TableHead,{children:"Metode"}),(0,b.jsx)(u.TableHead,{children:"Waktu Bayar"}),(0,b.jsx)(u.TableHead,{className:"text-right",children:"Aksi"})]})}),(0,b.jsx)(u.TableBody,{children:ac.map(a=>(0,b.jsxs)(u.TableRow,{children:[(0,b.jsx)(u.TableCell,{className:"font-medium",children:a.invoice_number}),(0,b.jsx)(u.TableCell,{children:(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.patient?.name}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.patient?.medical_record_number})]})}),(0,b.jsx)(u.TableCell,{children:(0,b.jsx)(s.Badge,{variant:"outline",children:a.medical_record?.department?.name||"-"})}),(0,b.jsx)(u.TableCell,{className:"text-right font-semibold",children:ad(a.total_amount)}),(0,b.jsx)(u.TableCell,{children:(0,b.jsx)(s.Badge,{variant:"secondary",children:a.payment_method_label||a.payment_method})}),(0,b.jsx)(u.TableCell,{className:"text-sm text-muted-foreground",children:a.payment_date?new Date(a.payment_date).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}):"-"}),(0,b.jsx)(u.TableCell,{className:"text-right",children:(0,b.jsxs)(p.Button,{size:"sm",variant:"outline",onClick:()=>{S(a),Q(!0)},children:[(0,b.jsx)(i.Receipt,{className:"h-4 w-4 mr-1"}),"Struk"]})})]},a.id))})]})})]})})]})}),(0,b.jsx)(v.PaymentModal,{open:N,onOpenChange:O,invoice:R,onSuccess:a=>{O(!1),aa(),a&&(S(a),Q(!0))}}),(0,b.jsx)(w.ReceiptModal,{open:P,onOpenChange:Q,invoice:R}),(0,b.jsx)(x.Dialog,{open:T,onOpenChange:U,children:(0,b.jsxs)(x.DialogContent,{className:"sm:max-w-[550px] max-h-[80vh] overflow-y-auto",children:[(0,b.jsxs)(x.DialogHeader,{children:[(0,b.jsxs)(x.DialogTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(n.Pill,{className:"h-5 w-5 text-green-600"}),"Detail Resep Obat"]}),(0,b.jsxs)(x.DialogDescription,{children:["Resep untuk pasien: ",X]})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[V.map((a,c)=>(0,b.jsxs)("div",{className:"space-y-3",children:[c>0&&(0,b.jsx)(y.Separator,{}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:a.prescription_number||`Resep #${c+1}`}),(0,b.jsxs)(s.Badge,{variant:"outline",className:"text-xs",children:[a.items?.length||0," item"]})]}),(0,b.jsx)("div",{className:"space-y-2",children:a.items?.map((a,c)=>(0,b.jsx)("div",{className:"p-3 border rounded-lg bg-muted/30",children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center flex-shrink-0",children:(0,b.jsx)(o.Package,{className:"h-4 w-4 text-green-600 dark:text-green-400"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.medicine_name}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-1 mt-1",children:[a.dosage&&(0,b.jsx)(s.Badge,{variant:"outline",className:"text-xs",children:a.dosage}),a.frequency&&(0,b.jsx)(s.Badge,{variant:"outline",className:"text-xs",children:a.frequency}),a.duration&&(0,b.jsx)(s.Badge,{variant:"outline",className:"text-xs",children:a.duration})]}),a.instructions&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Aturan: ",a.instructions]})]})]}),(0,b.jsxs)(s.Badge,{className:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300 flex-shrink-0",children:[a.quantity," pcs"]})]})},a.id))}),a.notes&&(0,b.jsxs)("div",{className:"p-2 bg-yellow-50 dark:bg-yellow-950/30 rounded text-sm text-yellow-800 dark:text-yellow-200",children:[(0,b.jsx)("span",{className:"font-medium",children:"Catatan:"})," ",a.notes]})]},a.id)),0===V.length&&(0,b.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,b.jsx)(n.Pill,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),(0,b.jsx)("p",{children:"Tidak ada data resep"})]})]})]})})]})}a.s(["default",()=>A],25890)}];

//# sourceMappingURL=src_app_%28dashboard%29_cashier_page_tsx_8fe7e67c._.js.map