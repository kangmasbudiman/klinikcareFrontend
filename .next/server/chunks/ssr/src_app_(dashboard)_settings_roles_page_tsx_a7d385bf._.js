module.exports=[21437,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(46271),e=a.i(23292),f=a.i(3314),g=a.i(16201),h=a.i(62722),i=a.i(43108),j=a.i(87532),k=a.i(15618),l=a.i(69520),m=a.i(81464),n=a.i(91119),o=a.i(99570),p=a.i(66718),q=a.i(80701),r=a.i(77156),s=a.i(24569),t=a.i(81560),u=a.i(30206),v=a.i(17755),w=a.i(13749),x=a.i(50522),y=a.i(60246),z=a.i(6015),A=a.i(35732),B=a.i(86304),C=a.i(28337);let D={getRoles:async(a={})=>(await C.default.get("/api/roles",{params:{search:a.search||void 0,status:"all"===a.status?void 0:a.status,page:a.page||1,per_page:a.per_page||10}})).data,getActiveRoles:async()=>(await C.default.get("/api/roles/active")).data,getRoleById:async a=>(await C.default.get(`/api/roles/${a}`)).data,createRole:async a=>(await C.default.post("/api/roles",a)).data,updateRole:async(a,b)=>(await C.default.put(`/api/roles/${a}`,b)).data,deleteRole:async a=>(await C.default.delete(`/api/roles/${a}`)).data,toggleRoleStatus:async a=>(await C.default.patch(`/api/roles/${a}/toggle-status`)).data,getRoleStats:async()=>(await C.default.get("/api/roles/stats")).data,updateRolePermissions:async(a,b)=>(await C.default.put(`/api/roles/${a}/permissions`,{permissions:b})).data,getPermissionsMatrix:async()=>(await C.default.get("/api/roles/permissions-matrix")).data,getColorOptions:()=>[{value:"red",label:"Merah",class:"bg-red-500"},{value:"blue",label:"Biru",class:"bg-blue-500"},{value:"green",label:"Hijau",class:"bg-green-500"},{value:"yellow",label:"Kuning",class:"bg-yellow-500"},{value:"purple",label:"Ungu",class:"bg-purple-500"},{value:"pink",label:"Pink",class:"bg-pink-500"},{value:"indigo",label:"Indigo",class:"bg-indigo-500"},{value:"cyan",label:"Cyan",class:"bg-cyan-500"},{value:"orange",label:"Oranye",class:"bg-orange-500"},{value:"teal",label:"Teal",class:"bg-teal-500"}],getColorClass(a){let b={red:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",blue:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",green:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",yellow:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",purple:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300",pink:"bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-300",indigo:"bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-300",cyan:"bg-cyan-100 text-cyan-800 dark:bg-cyan-900 dark:text-cyan-300",orange:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300",teal:"bg-teal-100 text-teal-800 dark:bg-teal-900 dark:text-teal-300"};return b[a||"blue"]||b.blue},getSolidColorClass(a){let b={red:"bg-red-500",blue:"bg-blue-500",green:"bg-green-500",yellow:"bg-yellow-500",purple:"bg-purple-500",pink:"bg-pink-500",indigo:"bg-indigo-500",cyan:"bg-cyan-500",orange:"bg-orange-500",teal:"bg-teal-500"};return b[a||"blue"]||b.blue}};function E(){return(0,b.jsxs)(z.TableRow,{children:[(0,b.jsx)(z.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"h-10 w-10 rounded-xl bg-muted animate-pulse"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("div",{className:"h-4 w-32 bg-muted animate-pulse rounded"}),(0,b.jsx)("div",{className:"h-3 w-20 bg-muted animate-pulse rounded"})]})]})}),(0,b.jsx)(z.TableCell,{children:(0,b.jsx)("div",{className:"h-4 w-48 bg-muted animate-pulse rounded"})}),(0,b.jsx)(z.TableCell,{children:(0,b.jsx)("div",{className:"h-4 w-16 bg-muted animate-pulse rounded"})}),(0,b.jsx)(z.TableCell,{children:(0,b.jsx)("div",{className:"h-4 w-16 bg-muted animate-pulse rounded"})}),(0,b.jsx)(z.TableCell,{children:(0,b.jsx)("div",{className:"h-6 w-16 bg-muted animate-pulse rounded-full"})}),(0,b.jsx)(z.TableCell,{children:(0,b.jsx)("div",{className:"h-8 w-8 bg-muted animate-pulse rounded"})})]})}function F(){return(0,b.jsx)(z.TableRow,{children:(0,b.jsx)(z.TableCell,{colSpan:6,className:"h-48",children:(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center text-center",children:[(0,b.jsx)("div",{className:"p-4 rounded-full bg-muted/50 mb-4",children:(0,b.jsx)(f.Shield,{className:"h-8 w-8 text-muted-foreground"})}),(0,b.jsx)("h3",{className:"font-semibold text-lg",children:"Tidak ada role"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Belum ada role yang sesuai dengan filter"})]})})})}function G({roles:a,isLoading:c=!1,currentPage:e,totalPages:g,onPageChange:h,onView:j,onEdit:k,onDelete:l,onToggleStatus:m}){return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("div",{className:"rounded-xl border bg-card overflow-hidden",children:(0,b.jsxs)(z.Table,{children:[(0,b.jsx)(z.TableHeader,{children:(0,b.jsxs)(z.TableRow,{className:"bg-muted/50 hover:bg-muted/50",children:[(0,b.jsx)(z.TableHead,{className:"font-semibold",children:"Role"}),(0,b.jsx)(z.TableHead,{className:"font-semibold",children:"Deskripsi"}),(0,b.jsx)(z.TableHead,{className:"font-semibold w-[120px]",children:"Permissions"}),(0,b.jsx)(z.TableHead,{className:"font-semibold w-[100px]",children:"Users"}),(0,b.jsx)(z.TableHead,{className:"font-semibold w-[100px]",children:"Status"}),(0,b.jsx)(z.TableHead,{className:"font-semibold w-[80px]",children:"Aksi"})]})}),(0,b.jsx)(z.TableBody,{children:c?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(E,{}),(0,b.jsx)(E,{}),(0,b.jsx)(E,{}),(0,b.jsx)(E,{}),(0,b.jsx)(E,{})]}):0===a.length?(0,b.jsx)(F,{}):a.map((a,c)=>(0,b.jsxs)(d.motion.tr,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.05*c},className:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",children:[(0,b.jsx)(z.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:`p-2.5 rounded-xl ${D.getSolidColorClass(a.color)} text-white`,children:(0,b.jsx)(f.Shield,{className:"h-5 w-5"})}),(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("p",{className:"font-medium truncate",children:a.display_name}),a.is_system&&(0,b.jsx)(i.Lock,{className:"h-3.5 w-3.5 text-muted-foreground"})]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.name})]})]})}),(0,b.jsx)(z.TableCell,{children:(0,b.jsx)("p",{className:"text-sm text-muted-foreground truncate max-w-xs",children:a.description||"-"})}),(0,b.jsx)(z.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)(f.Shield,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)("span",{className:"font-medium",children:a.permissions_count||0})]})}),(0,b.jsx)(z.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)(y.Users,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)("span",{className:"font-medium",children:a.users_count||0})]})}),(0,b.jsx)(z.TableCell,{children:(0,b.jsx)(B.Badge,{variant:a.is_active?"success":"error",children:a.is_active?"Aktif":"Nonaktif"})}),(0,b.jsx)(z.TableCell,{children:(0,b.jsxs)(A.DropdownMenu,{children:[(0,b.jsx)(A.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(o.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",children:[(0,b.jsx)(v.MoreHorizontal,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"sr-only",children:"Buka menu"})]})}),(0,b.jsxs)(A.DropdownMenuContent,{align:"end",className:"w-48",children:[(0,b.jsxs)(A.DropdownMenuItem,{onClick:()=>j(a),children:[(0,b.jsx)(r.Eye,{className:"mr-2 h-4 w-4"}),"Lihat Detail"]}),(0,b.jsxs)(A.DropdownMenuItem,{onClick:()=>k(a),children:[(0,b.jsx)(s.Edit,{className:"mr-2 h-4 w-4"}),"Edit"]}),!a.is_system&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(A.DropdownMenuItem,{onClick:()=>m(a),children:[(0,b.jsx)(u.Power,{className:"mr-2 h-4 w-4"}),a.is_active?"Nonaktifkan":"Aktifkan"]}),(0,b.jsx)(A.DropdownMenuSeparator,{}),(0,b.jsxs)(A.DropdownMenuItem,{onClick:()=>l(a),className:"text-destructive focus:text-destructive",disabled:(a.users_count||0)>0,children:[(0,b.jsx)(t.Trash2,{className:"mr-2 h-4 w-4"}),"Hapus"]})]})]})]})})]},a.id))})]})}),g>1&&(0,b.jsxs)("div",{className:"flex items-center justify-between px-2",children:[(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Halaman ",e," dari ",g]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:()=>h(e-1),disabled:e<=1,children:[(0,b.jsx)(w.ChevronLeft,{className:"h-4 w-4 mr-1"}),"Sebelumnya"]}),(0,b.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:()=>h(e+1),disabled:e>=g,children:["Selanjutnya",(0,b.jsx)(x.ChevronRight,{className:"h-4 w-4 ml-1"})]})]})]})]})}var H=a.i(95245),I=a.i(59501),J=a.i(62036),K=a.i(2835),L=a.i(4720),M=a.i(54347),N=a.i(96221),O=a.i(92e3),P=a.i(14574),Q=a.i(70430),R=a.i(63658),S=a.i(15055),T=a.i(76841),U=a.i(88780);let V=U.z.object({name:U.z.string().min(1,"Nama role wajib diisi").max(50,"Nama maksimal 50 karakter").regex(/^[a-z_]+$/,"Nama hanya boleh huruf kecil dan underscore (contoh: admin_klinik)"),display_name:U.z.string().min(1,"Nama tampilan wajib diisi").max(100,"Nama tampilan maksimal 100 karakter"),description:U.z.string().max(1e3,"Deskripsi maksimal 1000 karakter").optional().nullable().or(U.z.literal("")),color:U.z.string().max(20,"Warna maksimal 20 karakter").optional(),is_active:U.z.boolean().optional().default(!0),permissions:U.z.array(U.z.number()).optional()}),W={getPermissions:async(a={})=>(await C.default.get("/api/permissions",{params:{search:a.search||void 0,module:"all"===a.module?void 0:a.module,action:"all"===a.action?void 0:a.action,page:a.page||1,per_page:a.per_page||50}})).data,getGroupedPermissions:async()=>(await C.default.get("/api/permissions/grouped")).data,getPermissionById:async a=>(await C.default.get(`/api/permissions/${a}`)).data,getPermissionStats:async()=>(await C.default.get("/api/permissions/stats")).data,getModules:async()=>(await C.default.get("/api/permissions/modules")).data,getModuleLabels:()=>({dashboard:"Dashboard",users:"Pengguna",roles:"Hak Akses",departments:"Departemen",services:"Layanan",icd_codes:"Kode ICD",clinic_settings:"Pengaturan Klinik",patients:"Pasien",appointments:"Janji Temu",medical_records:"Rekam Medis",prescriptions:"Resep",billing:"Tagihan",payments:"Pembayaran",pharmacy:"Farmasi",inventory:"Inventaris",reports:"Laporan"}),getActionLabels:()=>({view:"Lihat",create:"Tambah",edit:"Edit",delete:"Hapus",manage:"Kelola",export:"Export"}),getActionColorClass(a){let b={view:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",create:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",edit:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",delete:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",manage:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300",export:"bg-cyan-100 text-cyan-800 dark:bg-cyan-900 dark:text-cyan-300"};return b[a]||b.view}};function X({open:a,onOpenChange:e,role:g,onSuccess:h}){let i=!!g,[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)([]),[n,r]=(0,c.useState)([]),{register:s,handleSubmit:t,setValue:u,watch:v,reset:w,control:x,formState:{errors:y}}=(0,H.useForm)({resolver:(0,I.zodResolver)(V),defaultValues:{name:"",display_name:"",description:"",color:"blue",is_active:!0,permissions:[]}}),z=v("color"),A=v("is_active");(0,c.useEffect)(()=>{let b=async()=>{try{let a=await D.getPermissionsMatrix();m(a.data)}catch(a){console.error("Error fetching permissions:",a)}};a&&b()},[a]),(0,c.useEffect)(()=>{a&&(g?(w({name:g.name,display_name:g.display_name,description:g.description||"",color:g.color||"blue",is_active:g.is_active,permissions:g.permissions?.map(a=>a.id)||[]}),r(g.permissions?.map(a=>a.id)||[])):(w({name:"",display_name:"",description:"",color:"blue",is_active:!0,permissions:[]}),r([])))},[a,g,w]);let B=a=>{let b=a.map(a=>a.id);b.every(a=>n.includes(a))?r(a=>a.filter(a=>!b.includes(a))):r(a=>[...new Set([...a,...b])])},C=async a=>{k(!0);try{let b={...a,permissions:n};i&&g?await D.updateRole(g.id,b):await D.createRole(b),h(),e(!1)}catch(a){console.error("Error saving role:",a)}finally{k(!1)}},E=D.getColorOptions(),F=W.getActionLabels();return(0,b.jsx)(P.Dialog,{open:a,onOpenChange:e,children:(0,b.jsxs)(P.DialogContent,{className:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(P.DialogHeader,{children:[(0,b.jsx)(P.DialogTitle,{className:"text-xl",children:i?"Edit Role":"Tambah Role Baru"}),(0,b.jsx)(P.DialogDescription,{children:i?"Perbarui informasi role dan hak akses.":"Isi informasi role baru dan pilih hak akses."})]}),(0,b.jsxs)("form",{onSubmit:t(C),className:"space-y-5 py-4",children:[(0,b.jsxs)(d.motion.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"flex items-center justify-center gap-4",children:[(0,b.jsx)("div",{className:`p-4 rounded-2xl ${D.getSolidColorClass(z||"blue")} text-white`,children:(0,b.jsx)(f.Shield,{className:"h-10 w-10"})}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Preview warna role"}),(0,b.jsxs)("p",{className:"font-medium mt-1",children:[n.length," permission dipilih"]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)(d.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},className:"space-y-2",children:[(0,b.jsxs)(Q.Label,{htmlFor:"name",className:"text-sm font-medium",children:["Nama Role ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(K.Hash,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(p.Input,{id:"name",placeholder:"admin_klinik",className:"pl-10 lowercase",...s("name"),onChange:a=>u("name",a.target.value.toLowerCase().replace(/\s/g,"_")),disabled:i&&g?.is_system})]}),(0,b.jsx)(J.AnimatePresence,{children:y.name&&(0,b.jsxs)(d.motion.p,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"text-sm text-destructive flex items-center gap-1",children:[(0,b.jsx)(O.AlertCircle,{className:"h-3 w-3"}),y.name.message]})})]}),(0,b.jsxs)(d.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.15},className:"space-y-2",children:[(0,b.jsxs)(Q.Label,{htmlFor:"display_name",className:"text-sm font-medium",children:["Nama Tampilan ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(f.Shield,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(p.Input,{id:"display_name",placeholder:"Admin Klinik",className:"pl-10",...s("display_name")})]}),(0,b.jsx)(J.AnimatePresence,{children:y.display_name&&(0,b.jsxs)(d.motion.p,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"text-sm text-destructive flex items-center gap-1",children:[(0,b.jsx)(O.AlertCircle,{className:"h-3 w-3"}),y.display_name.message]})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,b.jsxs)(d.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"col-span-2 space-y-2",children:[(0,b.jsx)(Q.Label,{htmlFor:"description",className:"text-sm font-medium",children:"Deskripsi"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(L.FileText,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,b.jsx)("textarea",{id:"description",placeholder:"Deskripsi singkat role...",className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 pl-10 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 resize-none",...s("description")})]})]}),(0,b.jsxs)(d.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.25},className:"space-y-2",children:[(0,b.jsx)(Q.Label,{className:"text-sm font-medium",children:"Warna"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(M.Palette,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground z-10"}),(0,b.jsx)(H.Controller,{name:"color",control:x,render:({field:a})=>(0,b.jsxs)(q.Select,{value:a.value||"",onValueChange:a.onChange,children:[(0,b.jsx)(q.SelectTrigger,{className:"pl-10",children:(0,b.jsx)(q.SelectValue,{placeholder:"Pilih warna",children:a.value&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:`w-4 h-4 rounded-full ${E.find(b=>b.value===a.value)?.class}`}),(0,b.jsx)("span",{className:"text-xs",children:E.find(b=>b.value===a.value)?.label})]})})}),(0,b.jsx)(q.SelectContent,{children:E.map(a=>(0,b.jsx)(q.SelectItem,{value:a.value,children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:`w-4 h-4 rounded-full ${a.class}`}),(0,b.jsx)("span",{children:a.label})]})},a.value))})]})})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-3 mt-4",children:[(0,b.jsx)("div",{className:"space-y-0.5",children:(0,b.jsx)(Q.Label,{htmlFor:"is_active",className:"text-sm font-medium",children:"Status Aktif"})}),(0,b.jsx)(R.Switch,{id:"is_active",checked:A,onCheckedChange:a=>u("is_active",a),disabled:i&&g?.is_system})]})]})]}),(0,b.jsxs)(d.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},className:"space-y-3",children:[(0,b.jsx)(Q.Label,{className:"text-sm font-medium",children:"Hak Akses / Permissions"}),(0,b.jsx)("div",{className:"border rounded-lg",children:(0,b.jsx)(T.Accordion,{type:"multiple",className:"w-full",children:l.map(a=>{var c;let d;return(0,b.jsxs)(T.AccordionItem,{value:a.module,children:[(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)("div",{className:"pl-4 pr-2 py-4 cursor-pointer",onClick:b=>{b.stopPropagation(),B(a.permissions)},children:(0,b.jsx)(S.Checkbox,{checked:a.permissions.every(a=>n.includes(a.id)),onCheckedChange:()=>B(a.permissions),className:(d=(c=a.permissions).filter(a=>n.includes(a.id))).length>0&&d.length<c.length?"opacity-50":""})}),(0,b.jsx)(T.AccordionTrigger,{className:"flex-1 pr-4 hover:no-underline",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("span",{className:"font-medium",children:a.label}),(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",a.permissions.filter(a=>n.includes(a.id)).length,"/",a.permissions.length,")"]})]})})]}),(0,b.jsx)(T.AccordionContent,{className:"px-4 pb-4",children:(0,b.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:a.permissions.map(a=>(0,b.jsxs)("label",{className:"flex items-center gap-2 p-2 rounded-lg hover:bg-muted cursor-pointer",children:[(0,b.jsx)(S.Checkbox,{checked:n.includes(a.id),onCheckedChange:()=>{var b;return b=a.id,void r(a=>a.includes(b)?a.filter(a=>a!==b):[...a,b])}}),(0,b.jsx)("span",{className:"text-sm",children:F[a.action]||a.action})]},a.id))})})]},a.module)})})})]})]}),(0,b.jsxs)(P.DialogFooter,{className:"gap-2 sm:gap-0",children:[(0,b.jsx)(o.Button,{type:"button",variant:"outline",onClick:()=>e(!1),disabled:j,children:"Batal"}),(0,b.jsx)(o.Button,{type:"submit",onClick:t(C),disabled:j,className:"min-w-[100px]",children:j?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(N.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Menyimpan..."]}):i?"Simpan Perubahan":"Tambah Role"})]})]})})}var Y=a.i(41675),Z=a.i(33441),$=a.i(5084),_=a.i(68114);function aa({open:a,onOpenChange:c,role:e,onEdit:j,onToggleStatus:k}){if(!e)return null;let l=W.getModuleLabels(),m=W.getActionLabels(),n=e.permissions?.reduce((a,b)=>(a[b.module]||(a[b.module]=[]),a[b.module].push(b),a),{})||{};return(0,b.jsx)(P.Dialog,{open:a,onOpenChange:c,children:(0,b.jsxs)(P.DialogContent,{className:"sm:max-w-[550px] max-h-[90vh] overflow-y-auto",children:[(0,b.jsx)(P.DialogHeader,{children:(0,b.jsx)(P.DialogTitle,{className:"text-xl",children:"Detail Role"})}),(0,b.jsxs)("div",{className:"py-4 space-y-6",children:[(0,b.jsxs)(d.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex flex-col items-center text-center",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:`p-5 rounded-2xl ${D.getSolidColorClass(e.color)} text-white`,children:(0,b.jsx)(f.Shield,{className:"h-12 w-12"})}),(0,b.jsx)("div",{className:`absolute -bottom-1 -right-1 w-6 h-6 rounded-full border-2 border-background flex items-center justify-center ${e.is_active?"bg-emerald-500":"bg-gray-400"}`,children:e.is_active?(0,b.jsx)(g.CheckCircle,{className:"h-4 w-4 text-white"}):(0,b.jsx)(h.XCircle,{className:"h-4 w-4 text-white"})})]}),(0,b.jsxs)("div",{className:"mt-4 flex items-center gap-2",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:e.display_name}),e.is_system&&(0,b.jsx)(i.Lock,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:e.name}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,b.jsx)(B.Badge,{variant:e.is_active?"success":"error",children:e.is_active?"Aktif":"Nonaktif"}),e.is_system&&(0,b.jsx)(B.Badge,{variant:"secondary",children:"System Role"})]})]}),(0,b.jsx)($.Separator,{}),(0,b.jsxs)(d.motion.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.1},className:"space-y-3",children:[e.description&&(0,b.jsxs)("div",{className:"p-3 rounded-lg bg-muted/50",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Deskripsi"}),(0,b.jsx)("p",{className:"text-sm",children:e.description})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted/50",children:[(0,b.jsx)("div",{className:"p-2 rounded-lg bg-blue-100 dark:bg-blue-950",children:(0,b.jsx)(f.Shield,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Permissions"}),(0,b.jsx)("p",{className:"text-lg font-semibold",children:e.permissions_count||0})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted/50",children:[(0,b.jsx)("div",{className:"p-2 rounded-lg bg-green-100 dark:bg-green-950",children:(0,b.jsx)(y.Users,{className:"h-4 w-4 text-green-600 dark:text-green-400"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Pengguna"}),(0,b.jsx)("p",{className:"text-lg font-semibold",children:e.users_count||0})]})]})]}),Object.keys(n).length>0&&(0,b.jsxs)("div",{className:"p-3 rounded-lg bg-muted/50 space-y-3",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground font-medium",children:"Hak Akses"}),(0,b.jsx)("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:Object.entries(n).map(([a,c])=>(0,b.jsxs)("div",{className:"flex items-start gap-2",children:[(0,b.jsx)("div",{className:"min-w-[120px] text-sm font-medium",children:l[a]||a}),(0,b.jsx)("div",{className:"flex flex-wrap gap-1",children:c?.map(a=>(0,b.jsxs)(B.Badge,{variant:"outline",className:"text-xs",children:[(0,b.jsx)(Z.Check,{className:"h-2.5 w-2.5 mr-1"}),m[a.action]||a.action]},a.id))})]},a))})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted/50",children:[(0,b.jsx)("div",{className:"p-2 rounded-lg bg-orange-100 dark:bg-orange-950",children:(0,b.jsx)(Y.Calendar,{className:"h-4 w-4 text-orange-600 dark:text-orange-400"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Dibuat Pada"}),(0,b.jsx)("p",{className:"text-sm font-medium",children:(0,_.formatDate)(e.created_at)})]})]})]}),(0,b.jsx)($.Separator,{}),(0,b.jsxs)(d.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"flex gap-2",children:[(0,b.jsxs)(o.Button,{variant:"outline",className:"flex-1",onClick:()=>{c(!1),j()},children:[(0,b.jsx)(s.Edit,{className:"mr-2 h-4 w-4"}),"Edit"]}),!e.is_system&&(0,b.jsxs)(o.Button,{variant:e.is_active?"destructive":"default",className:"flex-1",onClick:()=>{c(!1),k()},children:[(0,b.jsx)(u.Power,{className:"mr-2 h-4 w-4"}),e.is_active?"Nonaktifkan":"Aktifkan"]})]})]})]})})}var ab=a.i(73570);function ac({open:a,onOpenChange:e,role:g,onConfirm:h}){let[i,j]=(0,c.useState)(!1);if(!g)return null;let k=async()=>{j(!0);try{await h(),e(!1)}catch(a){console.error("Error deleting role:",a)}finally{j(!1)}},l=(g.users_count||0)>0;return(0,b.jsx)(P.Dialog,{open:a,onOpenChange:e,children:(0,b.jsxs)(P.DialogContent,{className:"sm:max-w-[400px]",children:[(0,b.jsxs)(P.DialogHeader,{children:[(0,b.jsxs)(P.DialogTitle,{className:"text-xl text-destructive flex items-center gap-2",children:[(0,b.jsx)(ab.AlertTriangle,{className:"h-5 w-5"}),"Hapus Role"]}),(0,b.jsx)(P.DialogDescription,{children:l?"Role ini tidak dapat dihapus karena masih memiliki pengguna.":"Tindakan ini tidak dapat dibatalkan. Data role akan dihapus secara permanen."})]}),(0,b.jsxs)(d.motion.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"py-4",children:[(0,b.jsxs)("div",{className:`flex items-center gap-4 p-4 rounded-xl ${l?"bg-yellow-50 dark:bg-yellow-950/20 border border-yellow-200 dark:border-yellow-800":"bg-destructive/10 border border-destructive/20"}`,children:[(0,b.jsx)("div",{className:`p-3 rounded-xl ${D.getSolidColorClass(g.color)} text-white`,children:(0,b.jsx)(f.Shield,{className:"h-8 w-8"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("h4",{className:"font-semibold truncate",children:g.display_name}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground truncate",children:g.name}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,b.jsx)(B.Badge,{variant:g.is_active?"success":"error",children:g.is_active?"Aktif":"Nonaktif"}),l&&(0,b.jsxs)(B.Badge,{variant:"outline",className:"gap-1",children:[(0,b.jsx)(y.Users,{className:"h-3 w-3"}),g.users_count," pengguna"]})]})]})]}),l?(0,b.jsx)("p",{className:"mt-4 text-sm text-yellow-600 dark:text-yellow-400 text-center",children:"Hapus atau pindahkan pengguna dari role ini terlebih dahulu."}):(0,b.jsx)("p",{className:"mt-4 text-sm text-muted-foreground text-center",children:"Apakah Anda yakin ingin menghapus role ini?"})]}),(0,b.jsxs)(P.DialogFooter,{className:"gap-2 sm:gap-0",children:[(0,b.jsx)(o.Button,{type:"button",variant:"outline",onClick:()=>e(!1),disabled:i,children:"Batal"}),(0,b.jsx)(o.Button,{type:"button",variant:"destructive",onClick:k,disabled:i||l,className:"min-w-[100px]",children:i?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(N.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Menghapus..."]}):"Ya, Hapus"})]})]})})}let ad=[{key:"total",title:"Total Role",icon:f.Shield,gradient:"from-blue-500 to-blue-600",bgLight:"bg-blue-50 dark:bg-blue-950/50",iconColor:"text-blue-600 dark:text-blue-400"},{key:"active",title:"Role Aktif",icon:g.CheckCircle,gradient:"from-emerald-500 to-emerald-600",bgLight:"bg-emerald-50 dark:bg-emerald-950/50",iconColor:"text-emerald-600 dark:text-emerald-400"},{key:"inactive",title:"Role Nonaktif",icon:h.XCircle,gradient:"from-red-500 to-red-600",bgLight:"bg-red-50 dark:bg-red-950/50",iconColor:"text-red-600 dark:text-red-400"},{key:"system",title:"System Role",icon:i.Lock,gradient:"from-purple-500 to-purple-600",bgLight:"bg-purple-50 dark:bg-purple-950/50",iconColor:"text-purple-600 dark:text-purple-400"}];function ae(){let[a,f]=(0,c.useState)([]),[g,h]=(0,c.useState)(null),[i,r]=(0,c.useState)(!0),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)(1),[w,x]=(0,c.useState)(1),[y,z]=(0,c.useState)({search:"",status:"all",page:1,per_page:10}),[A,B]=(0,c.useState)(!1),[C,E]=(0,c.useState)(!1),[F,H]=(0,c.useState)(!1),[I,J]=(0,c.useState)(null),K=(0,c.useCallback)(async()=>{try{let a=await D.getRoles(y);f(a.data),v(a.meta.current_page),x(a.meta.last_page)}catch(a){console.error("Error fetching roles:",a),e.toast.error("Gagal memuat data role")}},[y]),L=(0,c.useCallback)(async()=>{try{let a=await D.getRoleStats();h(a.data)}catch(a){console.error("Error fetching stats:",a)}},[]);(0,c.useEffect)(()=>{(async()=>{r(!0),await Promise.all([K(),L()]),r(!1)})()},[K,L]);let M=async()=>{t(!0),await Promise.all([K(),L()]),t(!1),e.toast.success("Data berhasil diperbarui")};(0,c.useEffect)(()=>{let a=setTimeout(()=>{z(a=>({...a,page:1}))},300);return()=>clearTimeout(a)},[y.search]);let N=(a,b)=>{z(c=>({...c,[a]:b,page:1}))},O=async a=>{try{let b=await D.getRoleById(a.id);J(b.data),E(!0)}catch(a){console.error("Error fetching role details:",a),e.toast.error("Gagal memuat detail role")}},P=async a=>{try{let b=await D.getRoleById(a.id);J(b.data),B(!0)}catch(a){console.error("Error fetching role details:",a),e.toast.error("Gagal memuat detail role")}},Q=async a=>{try{await D.toggleRoleStatus(a.id),e.toast.success(a.is_active?"Role berhasil dinonaktifkan":"Role berhasil diaktifkan"),await Promise.all([K(),L()])}catch(a){console.error("Error toggling status:",a),e.toast.error("Gagal mengubah status role")}},R=async()=>{e.toast.success(I?"Role berhasil diperbarui":"Role berhasil dibuat"),await Promise.all([K(),L()])},S=async()=>{if(I)try{await D.deleteRole(I.id),e.toast.success("Role berhasil dihapus"),await Promise.all([K(),L()])}catch(a){throw console.error("Error deleting role:",a),e.toast.error("Gagal menghapus role"),a}},T={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(d.motion.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl md:text-3xl font-bold",children:"Hak Akses"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:"Kelola role dan permission pengguna"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:M,disabled:s,children:[(0,b.jsx)(l.RefreshCw,{className:`h-4 w-4 mr-2 ${s?"animate-spin":""}`}),"Refresh"]}),(0,b.jsxs)(o.Button,{size:"sm",onClick:()=>{J(null),B(!0)},children:[(0,b.jsx)(k.Plus,{className:"h-4 w-4 mr-2"}),"Tambah Role"]})]})]}),(0,b.jsx)(d.motion.div,{variants:{hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},initial:"hidden",animate:"show",className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:ad.map(a=>{var c;return(0,b.jsx)(d.motion.div,{variants:T,children:(0,b.jsxs)(n.Card,{className:"relative overflow-hidden hover:shadow-lg transition-shadow",children:[(0,b.jsxs)(n.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(n.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:a.title}),(0,b.jsx)("div",{className:`p-2.5 rounded-xl ${a.bgLight}`,children:(0,b.jsx)(a.icon,{className:`h-5 w-5 ${a.iconColor}`})})]}),(0,b.jsx)(n.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl md:text-3xl font-bold",children:i?(0,b.jsx)("div",{className:"h-8 w-16 bg-muted animate-pulse rounded"}):(c=a.key,g&&g[c]||0)})}),(0,b.jsx)("div",{className:`absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r ${a.gradient}`})]})},a.key)})}),(0,b.jsx)(d.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},children:(0,b.jsx)(n.Card,{children:(0,b.jsx)(n.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center",children:[(0,b.jsxs)("div",{className:"relative flex-1",children:[(0,b.jsx)(j.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(p.Input,{placeholder:"Cari nama role...",className:"pl-10",value:y.search,onChange:a=>N("search",a.target.value)})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(m.Filter,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsxs)(q.Select,{value:y.status,onValueChange:a=>N("status",a),children:[(0,b.jsx)(q.SelectTrigger,{className:"w-[160px]",children:(0,b.jsx)(q.SelectValue,{placeholder:"Status"})}),(0,b.jsxs)(q.SelectContent,{children:[(0,b.jsx)(q.SelectItem,{value:"all",children:"Semua Status"}),(0,b.jsx)(q.SelectItem,{value:"active",children:"Aktif"}),(0,b.jsx)(q.SelectItem,{value:"inactive",children:"Nonaktif"})]})]})]})]})})})}),(0,b.jsx)(d.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},children:(0,b.jsx)(G,{roles:a,isLoading:i,currentPage:u,totalPages:w,onPageChange:a=>{z(b=>({...b,page:a}))},onView:O,onEdit:P,onDelete:a=>{J(a),H(!0)},onToggleStatus:Q})}),(0,b.jsx)(X,{open:A,onOpenChange:B,role:I,onSuccess:R}),(0,b.jsx)(aa,{open:C,onOpenChange:E,role:I,onEdit:()=>{E(!1),B(!0)},onToggleStatus:()=>{I&&Q(I)}}),(0,b.jsx)(ac,{open:F,onOpenChange:H,role:I,onConfirm:S})]})}a.s(["default",()=>ae],21437)}];

//# sourceMappingURL=src_app_%28dashboard%29_settings_roles_page_tsx_a7d385bf._.js.map