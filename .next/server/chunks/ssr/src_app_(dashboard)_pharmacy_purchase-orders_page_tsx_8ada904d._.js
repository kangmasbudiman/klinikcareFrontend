module.exports=[81981,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(95245),e=a.i(59501),f=a.i(88780),g=a.i(56711),h=a.i(93901),i=a.i(15618),j=a.i(87532),k=a.i(81464),l=a.i(17755),m=a.i(77156),n=a.i(99464),o=a.i(81560);let p=(0,a.i(70106).default)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var q=a.i(16201),r=a.i(62722),s=a.i(38784),t=a.i(83497),u=a.i(4720),v=a.i(96221),w=a.i(33508),x=a.i(23292),y=a.i(99570),z=a.i(66718),A=a.i(70430),B=a.i(29246),C=a.i(86304),D=a.i(91119),E=a.i(6015),F=a.i(14574),G=a.i(35732),H=a.i(80701),I=a.i(86192),J=a.i(82524),K=a.i(33140),L=a.i(85611),M=a.i(91159);let N=f.z.object({medicine_id:f.z.number().min(1,"Pilih obat"),quantity:f.z.number().min(1,"Jumlah minimal 1"),unit:f.z.string().min(1,"Unit harus diisi"),unit_price:f.z.number().min(0,"Harga tidak boleh negatif"),discount_percent:f.z.number().min(0).max(100).optional(),tax_percent:f.z.number().min(0).max(100).optional(),notes:f.z.string().optional()}),O=f.z.object({supplier_id:f.z.number().min(1,"Pilih supplier"),order_date:f.z.string().min(1,"Tanggal order harus diisi"),expected_delivery_date:f.z.string().optional(),notes:f.z.string().optional(),items:f.z.array(N).min(1,"Minimal 1 item")});function P(){let a,[f,N]=(0,c.useState)([]),[P,Q]=(0,c.useState)(null),[R,S]=(0,c.useState)([]),[T,U]=(0,c.useState)([]),[V,W]=(0,c.useState)(!0),[X,Y]=(0,c.useState)(!0),[Z,$]=(0,c.useState)(1),[_,aa]=(0,c.useState)(1),[ab,ac]=(0,c.useState)(0),[ad,ae]=(0,c.useState)({search:"",status:"all",supplier_id:void 0,page:1,per_page:10}),[af,ag]=(0,c.useState)(!1),[ah,ai]=(0,c.useState)(!1),[aj,ak]=(0,c.useState)(!1),[al,am]=(0,c.useState)(!1),[an,ao]=(0,c.useState)(!1),[ap,aq]=(0,c.useState)(!1),[ar,as]=(0,c.useState)(null),[at,au]=(0,c.useState)(!1),[av,aw]=(0,c.useState)(""),[ax,ay]=(0,c.useState)(""),az=(0,d.useForm)({resolver:(0,e.zodResolver)(O),defaultValues:{supplier_id:0,order_date:(0,g.format)(new Date,"yyyy-MM-dd"),expected_delivery_date:"",notes:"",items:[{medicine_id:0,quantity:1,unit:"",unit_price:0,discount_percent:0,tax_percent:0,notes:""}]}}),{fields:aA,append:aB,remove:aC}=(0,d.useFieldArray)({control:az.control,name:"items"}),aD=(0,c.useCallback)(async()=>{W(!0);try{let a=await L.purchaseOrderService.getPurchaseOrders({...ad,page:Z});N(a.data),aa(a.last_page),ac(a.total)}catch(a){console.error("Error fetching purchase orders:",a),x.toast.error("Gagal memuat data purchase order")}finally{W(!1)}},[ad,Z]),aE=async()=>{Y(!0);try{let a=await L.purchaseOrderService.getPurchaseOrderStats();Q(a)}catch(a){console.error("Error fetching stats:",a)}finally{Y(!1)}},aF=async()=>{try{let a=await L.supplierService.getActiveSuppliers();S(a.data)}catch(a){console.error("Error fetching suppliers:",a)}},aG=async()=>{try{let a=await L.medicineService.getMedicines({status:"active",per_page:1e3});console.log("Medicines data:",a.data),U(a.data)}catch(a){console.error("Error fetching medicines:",a)}};(0,c.useEffect)(()=>{aD(),aE(),aF(),aG()},[aD]);let aH=async a=>{if(a)try{let b=await L.purchaseOrderService.getPurchaseOrderById(a.id);as(b),az.reset({supplier_id:b.supplier_id,order_date:b.order_date,expected_delivery_date:b.expected_delivery_date||"",notes:b.notes||"",items:b.items?.map(a=>({medicine_id:a.medicine_id,quantity:a.quantity,unit:a.unit,unit_price:a.unit_price,discount_percent:a.discount_percent,tax_percent:a.tax_percent,notes:a.notes||""}))||[]}),ai(!0)}catch(a){x.toast.error("Gagal memuat detail PO")}else as(null),az.reset({supplier_id:0,order_date:(0,g.format)(new Date,"yyyy-MM-dd"),expected_delivery_date:"",notes:"",items:[{medicine_id:0,quantity:1,unit:"",unit_price:0,discount_percent:0,tax_percent:0,notes:""}]}),ai(!0)},aI=async a=>{try{let b=await L.purchaseOrderService.getPurchaseOrderById(a.id);as(b),ak(!0)}catch(a){x.toast.error("Gagal memuat detail PO")}},aJ=async a=>{au(!0);try{let b={supplier_id:a.supplier_id,order_date:a.order_date,expected_delivery_date:a.expected_delivery_date||void 0,notes:a.notes||void 0,items:a.items.map(a=>({medicine_id:a.medicine_id,quantity:a.quantity,unit:a.unit,unit_price:a.unit_price,discount_percent:a.discount_percent,tax_percent:a.tax_percent,notes:a.notes}))};ar?(await L.purchaseOrderService.updatePurchaseOrder(ar.id,b),x.toast.success("Purchase order berhasil diupdate")):(await L.purchaseOrderService.createPurchaseOrder(b),x.toast.success("Purchase order berhasil dibuat")),ai(!1),aD(),aE()}catch(a){x.toast.error(a?.response?.data?.message||"Gagal menyimpan purchase order")}finally{au(!1)}},aK=async()=>{if(ar){au(!0);try{await L.purchaseOrderService.deletePurchaseOrder(ar.id),x.toast.success("Purchase order berhasil dihapus"),am(!1),as(null),aD(),aE()}catch(a){x.toast.error(a?.response?.data?.message||"Gagal menghapus purchase order")}finally{au(!1)}}},aL=async a=>{try{await L.purchaseOrderService.submitForApproval(a.id),x.toast.success("PO berhasil diajukan untuk persetujuan"),aD(),aE()}catch(a){x.toast.error(a?.response?.data?.message||"Gagal mengajukan PO")}},aM=async()=>{if(ar){au(!0);try{await L.purchaseOrderService.approve(ar.id,ax||void 0),x.toast.success("PO berhasil disetujui"),ao(!1),as(null),ay(""),aD(),aE()}catch(a){x.toast.error(a?.response?.data?.message||"Gagal menyetujui PO")}finally{au(!1)}}},aN=async()=>{if(ar&&av){au(!0);try{await L.purchaseOrderService.reject(ar.id,av),x.toast.success("PO berhasil ditolak"),aq(!1),as(null),aw(""),aD(),aE()}catch(a){x.toast.error(a?.response?.data?.message||"Gagal menolak PO")}finally{au(!1)}}},aO=async a=>{try{await L.purchaseOrderService.markAsOrdered(a.id),x.toast.success("Status PO berhasil diubah menjadi dipesan"),aD(),aE()}catch(a){x.toast.error(a?.response?.data?.message||"Gagal mengubah status PO")}},aP=async a=>{try{await L.purchaseOrderService.cancel(a.id),x.toast.success("PO berhasil dibatalkan"),aD(),aE()}catch(a){x.toast.error(a?.response?.data?.message||"Gagal membatalkan PO")}},aQ=a=>{let b=az.watch(`items.${a}`);if(!b)return 0;let c=Number(b.quantity)||0,d=Number(b.unit_price)||0,e=Number(b.discount_percent)||0,f=Number(b.tax_percent)||0,g=c*d,h=g-e/100*g;return h+f/100*h},aR=a=>{let b=Number(a)||0;return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(b)},aS=a=>(0,b.jsx)(C.Badge,{className:M.PO_STATUS_COLORS[a],children:M.PO_STATUS_LABELS[a]});return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold tracking-tight",children:"Purchase Order"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Kelola pesanan pembelian obat ke supplier"})]}),(0,b.jsxs)(y.Button,{onClick:()=>aH(),children:[(0,b.jsx)(i.Plus,{className:"mr-2 h-4 w-4"}),"Buat PO Baru"]})]}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,b.jsxs)(D.Card,{children:[(0,b.jsxs)(D.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(D.CardTitle,{className:"text-sm font-medium",children:"Total PO"}),(0,b.jsx)(u.FileText,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(D.CardContent,{children:X?(0,b.jsx)(K.Skeleton,{className:"h-8 w-20"}):(0,b.jsx)("div",{className:"text-2xl font-bold",children:P?.total||0})})]}),(0,b.jsxs)(D.Card,{children:[(0,b.jsxs)(D.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(D.CardTitle,{className:"text-sm font-medium",children:"Menunggu Approval"}),(0,b.jsx)(s.ShoppingCart,{className:"h-4 w-4 text-yellow-500"})]}),(0,b.jsx)(D.CardContent,{children:X?(0,b.jsx)(K.Skeleton,{className:"h-8 w-20"}):(0,b.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:P?.pending_approval||0})})]}),(0,b.jsxs)(D.Card,{children:[(0,b.jsxs)(D.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(D.CardTitle,{className:"text-sm font-medium",children:"Perlu Diterima"}),(0,b.jsx)(t.Package,{className:"h-4 w-4 text-blue-500"})]}),(0,b.jsx)(D.CardContent,{children:X?(0,b.jsx)(K.Skeleton,{className:"h-8 w-20"}):(0,b.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:(P?.ordered||0)+(P?.partial_received||0)})})]}),(0,b.jsxs)(D.Card,{children:[(0,b.jsxs)(D.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(D.CardTitle,{className:"text-sm font-medium",children:"Nilai Bulan Ini"}),(0,b.jsx)(u.FileText,{className:"h-4 w-4 text-green-500"})]}),(0,b.jsx)(D.CardContent,{children:X?(0,b.jsx)(K.Skeleton,{className:"h-8 w-20"}):(0,b.jsx)("div",{className:"text-2xl font-bold text-green-600",children:aR(P?.total_value_this_month||0)})})]})]}),(0,b.jsx)(D.Card,{children:(0,b.jsxs)(D.CardContent,{className:"pt-6",children:[(0,b.jsx)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:(0,b.jsxs)("div",{className:"flex flex-1 items-center gap-2",children:[(0,b.jsxs)("div",{className:"relative flex-1 md:max-w-sm",children:[(0,b.jsx)(j.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,b.jsx)(z.Input,{placeholder:"Cari no. PO...",value:ad.search,onChange:a=>{var b;return b=a.target.value,void(ae(a=>({...a,search:b})),$(1))},className:"pl-9"})]}),(0,b.jsx)(y.Button,{variant:"outline",size:"icon",onClick:()=>ag(!af),children:(0,b.jsx)(k.Filter,{className:"h-4 w-4"})})]})}),af&&(0,b.jsxs)("div",{className:"mt-4 grid gap-4 md:grid-cols-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(A.Label,{children:"Status"}),(0,b.jsxs)(H.Select,{value:ad.status||"all",onValueChange:a=>{ae(b=>({...b,status:a})),$(1)},children:[(0,b.jsx)(H.SelectTrigger,{children:(0,b.jsx)(H.SelectValue,{placeholder:"Semua Status"})}),(0,b.jsxs)(H.SelectContent,{children:[(0,b.jsx)(H.SelectItem,{value:"all",children:"Semua Status"}),(0,b.jsx)(H.SelectItem,{value:"draft",children:"Draft"}),(0,b.jsx)(H.SelectItem,{value:"pending_approval",children:"Menunggu Approval"}),(0,b.jsx)(H.SelectItem,{value:"approved",children:"Disetujui"}),(0,b.jsx)(H.SelectItem,{value:"rejected",children:"Ditolak"}),(0,b.jsx)(H.SelectItem,{value:"ordered",children:"Dipesan"}),(0,b.jsx)(H.SelectItem,{value:"partial_received",children:"Diterima Sebagian"}),(0,b.jsx)(H.SelectItem,{value:"completed",children:"Selesai"}),(0,b.jsx)(H.SelectItem,{value:"cancelled",children:"Dibatalkan"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(A.Label,{children:"Supplier"}),(0,b.jsxs)(H.Select,{value:ad.supplier_id?.toString()||"all",onValueChange:a=>{ae(b=>({...b,supplier_id:a&&"all"!==a?parseInt(a):void 0})),$(1)},children:[(0,b.jsx)(H.SelectTrigger,{children:(0,b.jsx)(H.SelectValue,{placeholder:"Semua Supplier"})}),(0,b.jsxs)(H.SelectContent,{children:[(0,b.jsx)(H.SelectItem,{value:"all",children:"Semua Supplier"}),R.map(a=>(0,b.jsx)(H.SelectItem,{value:a.id.toString(),children:a.name},a.id))]})]})]}),(0,b.jsx)("div",{className:"flex items-end",children:(0,b.jsxs)(y.Button,{variant:"outline",size:"sm",onClick:()=>{ae({search:"",status:"all",supplier_id:void 0,page:1,per_page:10}),$(1)},children:[(0,b.jsx)(w.X,{className:"mr-2 h-4 w-4"}),"Reset Filter"]})})]})]})}),(0,b.jsxs)(D.Card,{children:[(0,b.jsx)(D.CardContent,{className:"p-0",children:(0,b.jsxs)(E.Table,{children:[(0,b.jsx)(E.TableHeader,{children:(0,b.jsxs)(E.TableRow,{children:[(0,b.jsx)(E.TableHead,{children:"No. PO"}),(0,b.jsx)(E.TableHead,{children:"Tanggal"}),(0,b.jsx)(E.TableHead,{children:"Supplier"}),(0,b.jsx)(E.TableHead,{children:"Total"}),(0,b.jsx)(E.TableHead,{children:"Status"}),(0,b.jsx)(E.TableHead,{children:"Dibuat Oleh"}),(0,b.jsx)(E.TableHead,{className:"text-right",children:"Aksi"})]})}),(0,b.jsx)(E.TableBody,{children:V?[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(E.TableRow,{children:(0,b.jsx)(E.TableCell,{colSpan:7,children:(0,b.jsx)(K.Skeleton,{className:"h-12 w-full"})})},c)):0===f.length?(0,b.jsx)(E.TableRow,{children:(0,b.jsx)(E.TableCell,{colSpan:7,className:"text-center py-8",children:(0,b.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,b.jsx)(u.FileText,{className:"h-8 w-8 text-muted-foreground"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Belum ada purchase order"})]})})}):f.map(a=>(0,b.jsxs)(E.TableRow,{children:[(0,b.jsx)(E.TableCell,{className:"font-medium",children:a.po_number}),(0,b.jsx)(E.TableCell,{children:(0,g.format)(new Date(a.order_date),"dd MMM yyyy",{locale:h.id})}),(0,b.jsx)(E.TableCell,{children:a.supplier?.name||"-"}),(0,b.jsx)(E.TableCell,{children:aR(a.total_amount)}),(0,b.jsx)(E.TableCell,{children:aS(a.status)}),(0,b.jsx)(E.TableCell,{children:a.creator?.name||"-"}),(0,b.jsx)(E.TableCell,{className:"text-right",children:(0,b.jsxs)(G.DropdownMenu,{children:[(0,b.jsx)(G.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(y.Button,{variant:"ghost",size:"icon",children:(0,b.jsx)(l.MoreHorizontal,{className:"h-4 w-4"})})}),(0,b.jsxs)(G.DropdownMenuContent,{align:"end",children:[(0,b.jsx)(G.DropdownMenuLabel,{children:"Aksi"}),(0,b.jsx)(G.DropdownMenuSeparator,{}),(0,b.jsxs)(G.DropdownMenuItem,{onClick:()=>aI(a),children:[(0,b.jsx)(m.Eye,{className:"mr-2 h-4 w-4"}),"Lihat Detail"]}),"draft"===a.status&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(G.DropdownMenuItem,{onClick:()=>aH(a),children:[(0,b.jsx)(n.Pencil,{className:"mr-2 h-4 w-4"}),"Edit"]}),(0,b.jsxs)(G.DropdownMenuItem,{onClick:()=>aL(a),children:[(0,b.jsx)(p,{className:"mr-2 h-4 w-4"}),"Ajukan Approval"]}),(0,b.jsx)(G.DropdownMenuSeparator,{}),(0,b.jsxs)(G.DropdownMenuItem,{className:"text-red-600",onClick:()=>{as(a),am(!0)},children:[(0,b.jsx)(o.Trash2,{className:"mr-2 h-4 w-4"}),"Hapus"]})]}),"pending_approval"===a.status&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(G.DropdownMenuItem,{onClick:()=>{as(a),ao(!0)},children:[(0,b.jsx)(q.CheckCircle,{className:"mr-2 h-4 w-4 text-green-600"}),"Setujui"]}),(0,b.jsxs)(G.DropdownMenuItem,{onClick:()=>{as(a),aq(!0)},children:[(0,b.jsx)(r.XCircle,{className:"mr-2 h-4 w-4 text-red-600"}),"Tolak"]})]}),"approved"===a.status&&(0,b.jsxs)(G.DropdownMenuItem,{onClick:()=>aO(a),children:[(0,b.jsx)(s.ShoppingCart,{className:"mr-2 h-4 w-4"}),"Tandai Sudah Dipesan"]}),["draft","pending_approval","approved"].includes(a.status)&&(0,b.jsxs)(G.DropdownMenuItem,{className:"text-red-600",onClick:()=>aP(a),children:[(0,b.jsx)(r.XCircle,{className:"mr-2 h-4 w-4"}),"Batalkan"]})]})]})})]},a.id))})]})}),_>1&&(0,b.jsxs)("div",{className:"flex items-center justify-between px-4 py-4 border-t",children:[(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Menampilkan ",f.length," dari ",ab," data"]}),(0,b.jsx)(J.Pagination,{currentPage:Z,totalPages:_,onPageChange:$})]})]}),(0,b.jsx)(F.Dialog,{open:ah,onOpenChange:ai,children:(0,b.jsxs)(F.DialogContent,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(F.DialogHeader,{children:[(0,b.jsx)(F.DialogTitle,{children:ar?"Edit Purchase Order":"Buat Purchase Order Baru"}),(0,b.jsx)(F.DialogDescription,{children:ar?"Ubah data purchase order":"Buat pesanan pembelian obat ke supplier"})]}),(0,b.jsxs)("form",{onSubmit:az.handleSubmit(aJ),className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(A.Label,{htmlFor:"supplier_id",children:["Supplier ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsxs)(H.Select,{value:az.watch("supplier_id")?.toString()||"",onValueChange:a=>az.setValue("supplier_id",parseInt(a)),children:[(0,b.jsx)(H.SelectTrigger,{children:(0,b.jsx)(H.SelectValue,{placeholder:"Pilih Supplier"})}),(0,b.jsx)(H.SelectContent,{children:R.map(a=>(0,b.jsx)(H.SelectItem,{value:a.id.toString(),children:a.name},a.id))})]}),az.formState.errors.supplier_id&&(0,b.jsx)("p",{className:"text-sm text-red-500",children:az.formState.errors.supplier_id.message})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(A.Label,{htmlFor:"order_date",children:["Tanggal Order ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(z.Input,{type:"date",...az.register("order_date")}),az.formState.errors.order_date&&(0,b.jsx)("p",{className:"text-sm text-red-500",children:az.formState.errors.order_date.message})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(A.Label,{htmlFor:"expected_delivery_date",children:"Estimasi Pengiriman"}),(0,b.jsx)(z.Input,{type:"date",...az.register("expected_delivery_date")})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(A.Label,{htmlFor:"notes",children:"Catatan"}),(0,b.jsx)(B.Textarea,{...az.register("notes"),placeholder:"Catatan tambahan...",rows:2})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(A.Label,{children:"Item Pesanan"}),(0,b.jsxs)(y.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>aB({medicine_id:0,quantity:1,unit:"",unit_price:0,discount_percent:0,tax_percent:0,notes:""}),children:[(0,b.jsx)(i.Plus,{className:"mr-2 h-4 w-4"}),"Tambah Item"]})]}),(0,b.jsx)("div",{className:"space-y-4",children:aA.map((a,c)=>(T.find(a=>a.id===az.watch(`items.${c}.medicine_id`)),(0,b.jsx)(D.Card,{className:"p-4",children:(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-6",children:[(0,b.jsxs)("div",{className:"md:col-span-2 space-y-2",children:[(0,b.jsx)(A.Label,{children:"Obat"}),(0,b.jsxs)(H.Select,{value:az.watch(`items.${c}.medicine_id`)?.toString()||"",onValueChange:a=>{let b=T.find(b=>b.id===parseInt(a));console.log("Selected medicine:",b),console.log("Purchase price:",b?.purchase_price),az.setValue(`items.${c}.medicine_id`,parseInt(a)),b&&(az.setValue(`items.${c}.unit`,b.unit||""),az.setValue(`items.${c}.unit_price`,Number(b.purchase_price)||0))},children:[(0,b.jsx)(H.SelectTrigger,{children:(0,b.jsx)(H.SelectValue,{placeholder:"Pilih Obat"})}),(0,b.jsx)(H.SelectContent,{children:T.map(a=>(0,b.jsx)(H.SelectItem,{value:a.id.toString(),children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(A.Label,{children:"Jumlah"}),(0,b.jsx)(z.Input,{type:"number",min:"1",...az.register(`items.${c}.quantity`,{valueAsNumber:!0})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(A.Label,{children:"Unit"}),(0,b.jsx)(z.Input,{...az.register(`items.${c}.unit`),placeholder:"Unit"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(A.Label,{children:"Harga Satuan"}),(0,b.jsx)(z.Input,{type:"number",min:"0",value:az.watch(`items.${c}.unit_price`)||0,onChange:a=>{az.setValue(`items.${c}.unit_price`,Number(a.target.value)||0)}})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(A.Label,{children:"Total"}),(0,b.jsx)("div",{className:"h-10 px-3 py-2 border rounded-md bg-muted text-sm",children:aR(aQ(c))})]}),aA.length>1&&(0,b.jsx)("div",{className:"flex items-end",children:(0,b.jsx)(y.Button,{type:"button",variant:"ghost",size:"icon",onClick:()=>aC(c),children:(0,b.jsx)(w.X,{className:"h-4 w-4 text-red-500"})})})]})},a.id)))}),az.formState.errors.items&&(0,b.jsx)("p",{className:"text-sm text-red-500",children:az.formState.errors.items.message}),(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Grand Total"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:aR((a=az.watch("items"))&&0!==a.length?a.reduce((a,b,c)=>a+aQ(c),0):0)})]})})]}),(0,b.jsxs)(F.DialogFooter,{children:[(0,b.jsx)(y.Button,{type:"button",variant:"outline",onClick:()=>ai(!1),children:"Batal"}),(0,b.jsxs)(y.Button,{type:"submit",disabled:at,children:[at&&(0,b.jsx)(v.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),ar?"Simpan Perubahan":"Buat PO"]})]})]})]})}),(0,b.jsx)(F.Dialog,{open:aj,onOpenChange:ak,children:(0,b.jsxs)(F.DialogContent,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(F.DialogHeader,{children:[(0,b.jsx)(F.DialogTitle,{children:"Detail Purchase Order"}),(0,b.jsx)(F.DialogDescription,{children:ar?.po_number})]}),ar&&(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Supplier"}),(0,b.jsx)("p",{className:"font-medium",children:ar.supplier?.name})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Status"}),aS(ar.status)]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Tanggal Order"}),(0,b.jsx)("p",{className:"font-medium",children:(0,g.format)(new Date(ar.order_date),"dd MMMM yyyy",{locale:h.id})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Dibuat Oleh"}),(0,b.jsx)("p",{className:"font-medium",children:ar.creator?.name})]}),ar.approved_by&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Disetujui Oleh"}),(0,b.jsx)("p",{className:"font-medium",children:ar.approver?.name})]}),ar.rejection_reason&&(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Alasan Penolakan"}),(0,b.jsx)("p",{className:"font-medium text-red-600",children:ar.rejection_reason})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium mb-2",children:"Item Pesanan"}),(0,b.jsxs)(E.Table,{children:[(0,b.jsx)(E.TableHeader,{children:(0,b.jsxs)(E.TableRow,{children:[(0,b.jsx)(E.TableHead,{children:"Obat"}),(0,b.jsx)(E.TableHead,{className:"text-right",children:"Qty"}),(0,b.jsx)(E.TableHead,{className:"text-right",children:"Harga"}),(0,b.jsx)(E.TableHead,{className:"text-right",children:"Diterima"}),(0,b.jsx)(E.TableHead,{className:"text-right",children:"Total"})]})}),(0,b.jsx)(E.TableBody,{children:ar.items?.map(a=>(0,b.jsxs)(E.TableRow,{children:[(0,b.jsx)(E.TableCell,{children:a.medicine?.name}),(0,b.jsxs)(E.TableCell,{className:"text-right",children:[a.quantity," ",a.unit]}),(0,b.jsx)(E.TableCell,{className:"text-right",children:aR(a.unit_price)}),(0,b.jsxs)(E.TableCell,{className:"text-right",children:[a.received_quantity," / ",a.quantity]}),(0,b.jsx)(E.TableCell,{className:"text-right",children:aR(a.total_price)})]},a.id))})]})]}),(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:aR(ar.total_amount)})]})})]})]})}),(0,b.jsx)(I.AlertDialog,{open:al,onOpenChange:am,children:(0,b.jsxs)(I.AlertDialogContent,{children:[(0,b.jsxs)(I.AlertDialogHeader,{children:[(0,b.jsx)(I.AlertDialogTitle,{children:"Hapus Purchase Order?"}),(0,b.jsxs)(I.AlertDialogDescription,{children:["PO ",ar?.po_number," akan dihapus permanen. Tindakan ini tidak dapat dibatalkan."]})]}),(0,b.jsxs)(I.AlertDialogFooter,{children:[(0,b.jsx)(I.AlertDialogCancel,{children:"Batal"}),(0,b.jsxs)(I.AlertDialogAction,{onClick:aK,className:"bg-red-600 hover:bg-red-700",disabled:at,children:[at&&(0,b.jsx)(v.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Hapus"]})]})]})}),(0,b.jsx)(I.AlertDialog,{open:an,onOpenChange:ao,children:(0,b.jsxs)(I.AlertDialogContent,{children:[(0,b.jsxs)(I.AlertDialogHeader,{children:[(0,b.jsx)(I.AlertDialogTitle,{children:"Setujui Purchase Order?"}),(0,b.jsxs)(I.AlertDialogDescription,{children:["PO ",ar?.po_number," dengan total"," ",aR(ar?.total_amount||0)," akan disetujui."]})]}),(0,b.jsxs)("div",{className:"py-4",children:[(0,b.jsx)(A.Label,{htmlFor:"approval_notes",children:"Catatan (Opsional)"}),(0,b.jsx)(B.Textarea,{id:"approval_notes",value:ax,onChange:a=>ay(a.target.value),placeholder:"Catatan persetujuan...",className:"mt-2"})]}),(0,b.jsxs)(I.AlertDialogFooter,{children:[(0,b.jsx)(I.AlertDialogCancel,{children:"Batal"}),(0,b.jsxs)(I.AlertDialogAction,{onClick:aM,className:"bg-green-600 hover:bg-green-700",disabled:at,children:[at&&(0,b.jsx)(v.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Setujui"]})]})]})}),(0,b.jsx)(I.AlertDialog,{open:ap,onOpenChange:aq,children:(0,b.jsxs)(I.AlertDialogContent,{children:[(0,b.jsxs)(I.AlertDialogHeader,{children:[(0,b.jsx)(I.AlertDialogTitle,{children:"Tolak Purchase Order?"}),(0,b.jsxs)(I.AlertDialogDescription,{children:["PO ",ar?.po_number," akan ditolak. Mohon berikan alasan penolakan."]})]}),(0,b.jsxs)("div",{className:"py-4",children:[(0,b.jsxs)(A.Label,{htmlFor:"reject_reason",children:["Alasan Penolakan ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(B.Textarea,{id:"reject_reason",value:av,onChange:a=>aw(a.target.value),placeholder:"Alasan penolakan...",className:"mt-2"})]}),(0,b.jsxs)(I.AlertDialogFooter,{children:[(0,b.jsx)(I.AlertDialogCancel,{children:"Batal"}),(0,b.jsxs)(I.AlertDialogAction,{onClick:aN,className:"bg-red-600 hover:bg-red-700",disabled:at||!av,children:[at&&(0,b.jsx)(v.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Tolak"]})]})]})})]})}a.s(["default",()=>P],81981)}];

//# sourceMappingURL=src_app_%28dashboard%29_pharmacy_purchase-orders_page_tsx_8ada904d._.js.map