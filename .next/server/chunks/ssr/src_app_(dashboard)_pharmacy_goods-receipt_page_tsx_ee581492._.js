module.exports=[36734,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(95245),e=a.i(59501),f=a.i(88780),g=a.i(56711),h=a.i(93901),i=a.i(15618),j=a.i(87532),k=a.i(81464),l=a.i(17755),m=a.i(77156),n=a.i(99464),o=a.i(81560),p=a.i(16201),q=a.i(62722),r=a.i(62143),s=a.i(83497),t=a.i(4720),u=a.i(96221),v=a.i(33508),w=a.i(73570),x=a.i(23292),y=a.i(99570),z=a.i(66718),A=a.i(70430),B=a.i(29246),C=a.i(86304),D=a.i(91119),E=a.i(6015),F=a.i(14574),G=a.i(35732),H=a.i(80701),I=a.i(86192),J=a.i(82524),K=a.i(33140),L=a.i(85611),M=a.i(91159);let N=f.z.object({purchase_order_item_id:f.z.number().optional(),medicine_id:f.z.number().min(1,"Pilih obat"),quantity:f.z.number().min(1,"Jumlah minimal 1"),unit:f.z.string().min(1,"Unit harus diisi"),unit_price:f.z.number().min(0,"Harga tidak boleh negatif"),batch_number:f.z.string().min(1,"No. batch harus diisi"),expiry_date:f.z.string().min(1,"Tanggal kadaluarsa harus diisi"),notes:f.z.string().optional()}),O=f.z.object({purchase_order_id:f.z.number().optional(),supplier_id:f.z.number().min(1,"Pilih supplier"),receipt_date:f.z.string().min(1,"Tanggal penerimaan harus diisi"),supplier_invoice_number:f.z.string().optional(),supplier_invoice_date:f.z.string().optional(),notes:f.z.string().optional(),items:f.z.array(N).min(1,"Minimal 1 item")});function P(){let[a,f]=(0,c.useState)([]),[N,P]=(0,c.useState)(null),[Q,R]=(0,c.useState)([]),[S,T]=(0,c.useState)([]),[U,V]=(0,c.useState)([]),[W,X]=(0,c.useState)(!0),[Y,Z]=(0,c.useState)(!0),[$,_]=(0,c.useState)(1),[aa,ab]=(0,c.useState)(1),[ac,ad]=(0,c.useState)(0),[ae,af]=(0,c.useState)({search:"",status:"all",supplier_id:void 0,page:1,per_page:10}),[ag,ah]=(0,c.useState)(!1),[ai,aj]=(0,c.useState)(!1),[ak,al]=(0,c.useState)(!1),[am,an]=(0,c.useState)(!1),[ao,ap]=(0,c.useState)(!1),[aq,ar]=(0,c.useState)(!1),[as,at]=(0,c.useState)(null),[au,av]=(0,c.useState)(!1),aw=(0,d.useForm)({resolver:(0,e.zodResolver)(O),defaultValues:{purchase_order_id:void 0,supplier_id:0,receipt_date:(0,g.format)(new Date,"yyyy-MM-dd"),supplier_invoice_number:"",supplier_invoice_date:"",notes:"",items:[{medicine_id:0,quantity:1,unit:"",unit_price:0,batch_number:"",expiry_date:"",notes:""}]}}),{fields:ax,append:ay,remove:az,replace:aA}=(0,d.useFieldArray)({control:aw.control,name:"items"}),aB=(0,c.useCallback)(async()=>{X(!0);try{let a=await L.goodsReceiptService.getGoodsReceipts({...ae,page:$});f(a.data),ab(a.last_page),ad(a.total)}catch(a){console.error("Error fetching goods receipts:",a),x.toast.error("Gagal memuat data penerimaan barang")}finally{X(!1)}},[ae,$]),aC=async()=>{Z(!0);try{let a=await L.goodsReceiptService.getGoodsReceiptStats();P(a)}catch(a){console.error("Error fetching stats:",a)}finally{Z(!1)}},aD=async()=>{try{let a=await L.supplierService.getActiveSuppliers();R(a.data)}catch(a){console.error("Error fetching suppliers:",a)}},aE=async()=>{try{let a=await L.medicineService.getActiveMedicines({});T(a.data)}catch(a){console.error("Error fetching medicines:",a)}},aF=async()=>{try{let a=await L.purchaseOrderService.getNeedsReceiving();V(a)}catch(a){console.error("Error fetching pending POs:",a)}};(0,c.useEffect)(()=>{aB(),aC(),aD(),aE(),aF()},[aB]);let aG=a=>{a?(at(a),aw.reset({purchase_order_id:a.purchase_order_id||void 0,supplier_id:a.supplier_id,receipt_date:a.receipt_date,supplier_invoice_number:a.supplier_invoice_number||"",supplier_invoice_date:a.supplier_invoice_date||"",notes:a.notes||"",items:a.items?.map(a=>({purchase_order_item_id:a.purchase_order_item_id||void 0,medicine_id:a.medicine_id,quantity:a.quantity,unit:a.unit,unit_price:a.unit_price,batch_number:a.batch_number,expiry_date:a.expiry_date,notes:a.notes||""}))||[]})):(at(null),aw.reset({purchase_order_id:void 0,supplier_id:0,receipt_date:(0,g.format)(new Date,"yyyy-MM-dd"),supplier_invoice_number:"",supplier_invoice_date:"",notes:"",items:[{medicine_id:0,quantity:1,unit:"",unit_price:0,batch_number:"",expiry_date:"",notes:""}]})),aj(!0)},aH=async a=>{try{let b=await L.goodsReceiptService.createFromPo(a.id);aw.reset({purchase_order_id:a.id,supplier_id:a.supplier_id,receipt_date:(0,g.format)(new Date,"yyyy-MM-dd"),supplier_invoice_number:"",supplier_invoice_date:"",notes:"",items:b.items.map(a=>({purchase_order_item_id:a.purchase_order_item_id,medicine_id:a.medicine_id,quantity:a.quantity,unit:a.unit,unit_price:a.unit_price,batch_number:"",expiry_date:"",notes:""}))}),ar(!1),aj(!0)}catch(a){x.toast.error("Gagal memuat data dari PO")}},aI=async a=>{try{let b=await L.goodsReceiptService.getGoodsReceiptById(a.id);at(b),al(!0)}catch(a){x.toast.error("Gagal memuat detail penerimaan")}},aJ=async a=>{av(!0);try{let b={purchase_order_id:a.purchase_order_id,supplier_id:a.supplier_id,receipt_date:a.receipt_date,supplier_invoice_number:a.supplier_invoice_number||void 0,supplier_invoice_date:a.supplier_invoice_date||void 0,notes:a.notes||void 0,items:a.items.map(a=>({purchase_order_item_id:a.purchase_order_item_id,medicine_id:a.medicine_id,quantity:a.quantity,unit:a.unit,unit_price:a.unit_price,batch_number:a.batch_number,expiry_date:a.expiry_date,notes:a.notes}))};as?(await L.goodsReceiptService.updateGoodsReceipt(as.id,b),x.toast.success("Penerimaan barang berhasil diupdate")):(await L.goodsReceiptService.createGoodsReceipt(b),x.toast.success("Penerimaan barang berhasil dibuat")),aj(!1),aB(),aC(),aF()}catch(a){x.toast.error(a?.response?.data?.message||"Gagal menyimpan penerimaan barang")}finally{av(!1)}},aK=async()=>{if(as){av(!0);try{await L.goodsReceiptService.deleteGoodsReceipt(as.id),x.toast.success("Penerimaan barang berhasil dihapus"),an(!1),at(null),aB(),aC()}catch(a){x.toast.error(a?.response?.data?.message||"Gagal menghapus penerimaan barang")}finally{av(!1)}}},aL=async()=>{if(as){av(!0);try{await L.goodsReceiptService.complete(as.id),x.toast.success("Penerimaan barang selesai. Stok telah diupdate."),ap(!1),at(null),aB(),aC(),aF()}catch(a){x.toast.error(a?.response?.data?.message||"Gagal menyelesaikan penerimaan")}finally{av(!1)}}},aM=async a=>{try{await L.goodsReceiptService.cancel(a.id),x.toast.success("Penerimaan barang berhasil dibatalkan"),aB(),aC()}catch(a){x.toast.error(a?.response?.data?.message||"Gagal membatalkan penerimaan")}},aN=a=>{let b=aw.watch(`items.${a}`);return b?b.quantity*b.unit_price:0},aO=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a),aP=a=>(0,b.jsx)(C.Badge,{className:M.GR_STATUS_COLORS[a],children:M.GR_STATUS_LABELS[a]});return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold tracking-tight",children:"Penerimaan Barang"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Kelola penerimaan barang dari supplier"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[U.length>0&&(0,b.jsxs)(y.Button,{variant:"outline",onClick:()=>ar(!0),children:[(0,b.jsx)(s.Package,{className:"mr-2 h-4 w-4"}),"Dari PO (",U.length,")"]}),(0,b.jsxs)(y.Button,{onClick:()=>aG(),children:[(0,b.jsx)(i.Plus,{className:"mr-2 h-4 w-4"}),"Penerimaan Baru"]})]})]}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,b.jsxs)(D.Card,{children:[(0,b.jsxs)(D.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(D.CardTitle,{className:"text-sm font-medium",children:"Total Penerimaan"}),(0,b.jsx)(t.FileText,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(D.CardContent,{children:Y?(0,b.jsx)(K.Skeleton,{className:"h-8 w-20"}):(0,b.jsx)("div",{className:"text-2xl font-bold",children:N?.total||0})})]}),(0,b.jsxs)(D.Card,{children:[(0,b.jsxs)(D.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(D.CardTitle,{className:"text-sm font-medium",children:"Draft"}),(0,b.jsx)(r.PackageCheck,{className:"h-4 w-4 text-yellow-500"})]}),(0,b.jsx)(D.CardContent,{children:Y?(0,b.jsx)(K.Skeleton,{className:"h-8 w-20"}):(0,b.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:N?.draft||0})})]}),(0,b.jsxs)(D.Card,{children:[(0,b.jsxs)(D.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(D.CardTitle,{className:"text-sm font-medium",children:"Hari Ini"}),(0,b.jsx)(s.Package,{className:"h-4 w-4 text-blue-500"})]}),(0,b.jsx)(D.CardContent,{children:Y?(0,b.jsx)(K.Skeleton,{className:"h-8 w-20"}):(0,b.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:N?.total_today||0})})]}),(0,b.jsxs)(D.Card,{children:[(0,b.jsxs)(D.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(D.CardTitle,{className:"text-sm font-medium",children:"Nilai Bulan Ini"}),(0,b.jsx)(t.FileText,{className:"h-4 w-4 text-green-500"})]}),(0,b.jsx)(D.CardContent,{children:Y?(0,b.jsx)(K.Skeleton,{className:"h-8 w-20"}):(0,b.jsx)("div",{className:"text-2xl font-bold text-green-600",children:aO(N?.total_value_this_month||0)})})]})]}),(0,b.jsx)(D.Card,{children:(0,b.jsxs)(D.CardContent,{className:"pt-6",children:[(0,b.jsx)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:(0,b.jsxs)("div",{className:"flex flex-1 items-center gap-2",children:[(0,b.jsxs)("div",{className:"relative flex-1 md:max-w-sm",children:[(0,b.jsx)(j.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,b.jsx)(z.Input,{placeholder:"Cari no. penerimaan...",value:ae.search,onChange:a=>{var b;return b=a.target.value,void(af(a=>({...a,search:b})),_(1))},className:"pl-9"})]}),(0,b.jsx)(y.Button,{variant:"outline",size:"icon",onClick:()=>ah(!ag),children:(0,b.jsx)(k.Filter,{className:"h-4 w-4"})})]})}),ag&&(0,b.jsxs)("div",{className:"mt-4 grid gap-4 md:grid-cols-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(A.Label,{children:"Status"}),(0,b.jsxs)(H.Select,{value:ae.status,onValueChange:a=>{af(b=>({...b,status:a})),_(1)},children:[(0,b.jsx)(H.SelectTrigger,{children:(0,b.jsx)(H.SelectValue,{placeholder:"Semua Status"})}),(0,b.jsxs)(H.SelectContent,{children:[(0,b.jsx)(H.SelectItem,{value:"all",children:"Semua Status"}),(0,b.jsx)(H.SelectItem,{value:"draft",children:"Draft"}),(0,b.jsx)(H.SelectItem,{value:"completed",children:"Selesai"}),(0,b.jsx)(H.SelectItem,{value:"cancelled",children:"Dibatalkan"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(A.Label,{children:"Supplier"}),(0,b.jsxs)(H.Select,{value:ae.supplier_id?.toString()||"",onValueChange:a=>{af(b=>({...b,supplier_id:a?parseInt(a):void 0})),_(1)},children:[(0,b.jsx)(H.SelectTrigger,{children:(0,b.jsx)(H.SelectValue,{placeholder:"Semua Supplier"})}),(0,b.jsxs)(H.SelectContent,{children:[(0,b.jsx)(H.SelectItem,{value:"",children:"Semua Supplier"}),Q.map(a=>(0,b.jsx)(H.SelectItem,{value:a.id.toString(),children:a.name},a.id))]})]})]})]})]})}),(0,b.jsxs)(D.Card,{children:[(0,b.jsx)(D.CardContent,{className:"p-0",children:(0,b.jsxs)(E.Table,{children:[(0,b.jsx)(E.TableHeader,{children:(0,b.jsxs)(E.TableRow,{children:[(0,b.jsx)(E.TableHead,{children:"No. Penerimaan"}),(0,b.jsx)(E.TableHead,{children:"Tanggal"}),(0,b.jsx)(E.TableHead,{children:"Supplier"}),(0,b.jsx)(E.TableHead,{children:"No. PO"}),(0,b.jsx)(E.TableHead,{children:"Total"}),(0,b.jsx)(E.TableHead,{children:"Status"}),(0,b.jsx)(E.TableHead,{className:"text-right",children:"Aksi"})]})}),(0,b.jsx)(E.TableBody,{children:W?[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(E.TableRow,{children:(0,b.jsx)(E.TableCell,{colSpan:7,children:(0,b.jsx)(K.Skeleton,{className:"h-12 w-full"})})},c)):0===a.length?(0,b.jsx)(E.TableRow,{children:(0,b.jsx)(E.TableCell,{colSpan:7,className:"text-center py-8",children:(0,b.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,b.jsx)(r.PackageCheck,{className:"h-8 w-8 text-muted-foreground"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Belum ada penerimaan barang"})]})})}):a.map(a=>(0,b.jsxs)(E.TableRow,{children:[(0,b.jsx)(E.TableCell,{className:"font-medium",children:a.receipt_number}),(0,b.jsx)(E.TableCell,{children:(0,g.format)(new Date(a.receipt_date),"dd MMM yyyy",{locale:h.id})}),(0,b.jsx)(E.TableCell,{children:a.supplier?.name||"-"}),(0,b.jsx)(E.TableCell,{children:a.purchase_order?.po_number||"-"}),(0,b.jsx)(E.TableCell,{children:aO(a.total_amount)}),(0,b.jsx)(E.TableCell,{children:aP(a.status)}),(0,b.jsx)(E.TableCell,{className:"text-right",children:(0,b.jsxs)(G.DropdownMenu,{children:[(0,b.jsx)(G.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(y.Button,{variant:"ghost",size:"icon",children:(0,b.jsx)(l.MoreHorizontal,{className:"h-4 w-4"})})}),(0,b.jsxs)(G.DropdownMenuContent,{align:"end",children:[(0,b.jsx)(G.DropdownMenuLabel,{children:"Aksi"}),(0,b.jsx)(G.DropdownMenuSeparator,{}),(0,b.jsxs)(G.DropdownMenuItem,{onClick:()=>aI(a),children:[(0,b.jsx)(m.Eye,{className:"mr-2 h-4 w-4"}),"Lihat Detail"]}),"draft"===a.status&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(G.DropdownMenuItem,{onClick:()=>aG(a),children:[(0,b.jsx)(n.Pencil,{className:"mr-2 h-4 w-4"}),"Edit"]}),(0,b.jsxs)(G.DropdownMenuItem,{onClick:()=>{at(a),ap(!0)},children:[(0,b.jsx)(p.CheckCircle,{className:"mr-2 h-4 w-4 text-green-600"}),"Selesaikan"]}),(0,b.jsx)(G.DropdownMenuSeparator,{}),(0,b.jsxs)(G.DropdownMenuItem,{className:"text-red-600",onClick:()=>aM(a),children:[(0,b.jsx)(q.XCircle,{className:"mr-2 h-4 w-4"}),"Batalkan"]}),(0,b.jsxs)(G.DropdownMenuItem,{className:"text-red-600",onClick:()=>{at(a),an(!0)},children:[(0,b.jsx)(o.Trash2,{className:"mr-2 h-4 w-4"}),"Hapus"]})]})]})]})})]},a.id))})]})}),aa>1&&(0,b.jsxs)("div",{className:"flex items-center justify-between px-4 py-4 border-t",children:[(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Menampilkan ",a.length," dari ",ac," data"]}),(0,b.jsx)(J.Pagination,{currentPage:$,totalPages:aa,onPageChange:_})]})]}),(0,b.jsx)(F.Dialog,{open:aq,onOpenChange:ar,children:(0,b.jsxs)(F.DialogContent,{className:"max-w-2xl",children:[(0,b.jsxs)(F.DialogHeader,{children:[(0,b.jsx)(F.DialogTitle,{children:"Pilih Purchase Order"}),(0,b.jsx)(F.DialogDescription,{children:"Pilih PO yang akan diterima barangnya"})]}),(0,b.jsx)("div",{className:"max-h-96 overflow-y-auto",children:(0,b.jsxs)(E.Table,{children:[(0,b.jsx)(E.TableHeader,{children:(0,b.jsxs)(E.TableRow,{children:[(0,b.jsx)(E.TableHead,{children:"No. PO"}),(0,b.jsx)(E.TableHead,{children:"Supplier"}),(0,b.jsx)(E.TableHead,{children:"Tanggal"}),(0,b.jsx)(E.TableHead,{className:"text-right",children:"Aksi"})]})}),(0,b.jsx)(E.TableBody,{children:U.map(a=>(0,b.jsxs)(E.TableRow,{children:[(0,b.jsx)(E.TableCell,{className:"font-medium",children:a.po_number}),(0,b.jsx)(E.TableCell,{children:a.supplier?.name}),(0,b.jsx)(E.TableCell,{children:(0,g.format)(new Date(a.order_date),"dd MMM yyyy",{locale:h.id})}),(0,b.jsx)(E.TableCell,{className:"text-right",children:(0,b.jsx)(y.Button,{size:"sm",onClick:()=>aH(a),children:"Pilih"})})]},a.id))})]})})]})}),(0,b.jsx)(F.Dialog,{open:ai,onOpenChange:aj,children:(0,b.jsxs)(F.DialogContent,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(F.DialogHeader,{children:[(0,b.jsx)(F.DialogTitle,{children:as?"Edit Penerimaan Barang":"Penerimaan Barang Baru"}),(0,b.jsx)(F.DialogDescription,{children:as?"Ubah data penerimaan barang":"Input penerimaan barang dari supplier"})]}),(0,b.jsxs)("form",{onSubmit:aw.handleSubmit(aJ),className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(A.Label,{htmlFor:"supplier_id",children:["Supplier ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsxs)(H.Select,{value:aw.watch("supplier_id")?.toString()||"",onValueChange:a=>aw.setValue("supplier_id",parseInt(a)),disabled:!!aw.watch("purchase_order_id"),children:[(0,b.jsx)(H.SelectTrigger,{children:(0,b.jsx)(H.SelectValue,{placeholder:"Pilih Supplier"})}),(0,b.jsx)(H.SelectContent,{children:Q.map(a=>(0,b.jsx)(H.SelectItem,{value:a.id.toString(),children:a.name},a.id))})]}),aw.formState.errors.supplier_id&&(0,b.jsx)("p",{className:"text-sm text-red-500",children:aw.formState.errors.supplier_id.message})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(A.Label,{htmlFor:"receipt_date",children:["Tanggal Penerimaan ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(z.Input,{type:"date",...aw.register("receipt_date")}),aw.formState.errors.receipt_date&&(0,b.jsx)("p",{className:"text-sm text-red-500",children:aw.formState.errors.receipt_date.message})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(A.Label,{htmlFor:"supplier_invoice_number",children:"No. Faktur Supplier"}),(0,b.jsx)(z.Input,{...aw.register("supplier_invoice_number"),placeholder:"Nomor faktur dari supplier"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(A.Label,{htmlFor:"supplier_invoice_date",children:"Tanggal Faktur"}),(0,b.jsx)(z.Input,{type:"date",...aw.register("supplier_invoice_date")})]}),(0,b.jsxs)("div",{className:"md:col-span-2 space-y-2",children:[(0,b.jsx)(A.Label,{htmlFor:"notes",children:"Catatan"}),(0,b.jsx)(B.Textarea,{...aw.register("notes"),placeholder:"Catatan tambahan...",rows:2})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(A.Label,{children:"Item Penerimaan"}),(0,b.jsxs)(y.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>ay({medicine_id:0,quantity:1,unit:"",unit_price:0,batch_number:"",expiry_date:"",notes:""}),children:[(0,b.jsx)(i.Plus,{className:"mr-2 h-4 w-4"}),"Tambah Item"]})]}),(0,b.jsx)("div",{className:"space-y-4",children:ax.map((a,c)=>{let d=aw.watch(`items.${c}.expiry_date`),e=d&&new Date(d)<new Date(Date.now()+7776e6);return(0,b.jsxs)(D.Card,{className:"p-4",children:[(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-6",children:[(0,b.jsxs)("div",{className:"md:col-span-2 space-y-2",children:[(0,b.jsx)(A.Label,{children:"Obat"}),(0,b.jsxs)(H.Select,{value:aw.watch(`items.${c}.medicine_id`)?.toString()||"",onValueChange:a=>{let b=S.find(b=>b.id===parseInt(a));aw.setValue(`items.${c}.medicine_id`,parseInt(a)),b&&(aw.setValue(`items.${c}.unit`,b.unit),aw.setValue(`items.${c}.unit_price`,b.purchase_price))},children:[(0,b.jsx)(H.SelectTrigger,{children:(0,b.jsx)(H.SelectValue,{placeholder:"Pilih Obat"})}),(0,b.jsx)(H.SelectContent,{children:S.map(a=>(0,b.jsx)(H.SelectItem,{value:a.id.toString(),children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(A.Label,{children:"Jumlah"}),(0,b.jsx)(z.Input,{type:"number",min:"1",...aw.register(`items.${c}.quantity`,{valueAsNumber:!0})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(A.Label,{children:"Harga Satuan"}),(0,b.jsx)(z.Input,{type:"number",min:"0",...aw.register(`items.${c}.unit_price`,{valueAsNumber:!0})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(A.Label,{children:["No. Batch ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(z.Input,{...aw.register(`items.${c}.batch_number`),placeholder:"No. Batch"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(A.Label,{children:["Kadaluarsa ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(z.Input,{type:"date",...aw.register(`items.${c}.expiry_date`),className:e?"border-yellow-500":""}),e&&(0,b.jsx)(w.AlertTriangle,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-yellow-500"})]})]}),ax.length>1&&(0,b.jsx)("div",{className:"flex items-end",children:(0,b.jsx)(y.Button,{type:"button",variant:"ghost",size:"icon",onClick:()=>az(c),children:(0,b.jsx)(v.X,{className:"h-4 w-4 text-red-500"})})})]}),(0,b.jsx)("div",{className:"mt-2 flex justify-end",children:(0,b.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Subtotal: ",aO(aN(c))]})})]},a.id)})}),aw.formState.errors.items&&(0,b.jsx)("p",{className:"text-sm text-red-500",children:aw.formState.errors.items.message}),(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Grand Total"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:aO(aw.watch("items").reduce((a,b,c)=>a+aN(c),0))})]})})]}),(0,b.jsxs)(F.DialogFooter,{children:[(0,b.jsx)(y.Button,{type:"button",variant:"outline",onClick:()=>aj(!1),children:"Batal"}),(0,b.jsxs)(y.Button,{type:"submit",disabled:au,children:[au&&(0,b.jsx)(u.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),as?"Simpan Perubahan":"Simpan Draft"]})]})]})]})}),(0,b.jsx)(F.Dialog,{open:ak,onOpenChange:al,children:(0,b.jsxs)(F.DialogContent,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(F.DialogHeader,{children:[(0,b.jsx)(F.DialogTitle,{children:"Detail Penerimaan Barang"}),(0,b.jsx)(F.DialogDescription,{children:as?.receipt_number})]}),as&&(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Supplier"}),(0,b.jsx)("p",{className:"font-medium",children:as.supplier?.name})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Status"}),aP(as.status)]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Tanggal Penerimaan"}),(0,b.jsx)("p",{className:"font-medium",children:(0,g.format)(new Date(as.receipt_date),"dd MMMM yyyy",{locale:h.id})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No. PO"}),(0,b.jsx)("p",{className:"font-medium",children:as.purchase_order?.po_number||"-"})]}),as.supplier_invoice_number&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No. Faktur Supplier"}),(0,b.jsx)("p",{className:"font-medium",children:as.supplier_invoice_number})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Diterima Oleh"}),(0,b.jsx)("p",{className:"font-medium",children:as.receiver?.name})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium mb-2",children:"Item Penerimaan"}),(0,b.jsxs)(E.Table,{children:[(0,b.jsx)(E.TableHeader,{children:(0,b.jsxs)(E.TableRow,{children:[(0,b.jsx)(E.TableHead,{children:"Obat"}),(0,b.jsx)(E.TableHead,{children:"No. Batch"}),(0,b.jsx)(E.TableHead,{children:"Kadaluarsa"}),(0,b.jsx)(E.TableHead,{className:"text-right",children:"Qty"}),(0,b.jsx)(E.TableHead,{className:"text-right",children:"Harga"}),(0,b.jsx)(E.TableHead,{className:"text-right",children:"Total"})]})}),(0,b.jsx)(E.TableBody,{children:as.items?.map(a=>(0,b.jsxs)(E.TableRow,{children:[(0,b.jsx)(E.TableCell,{children:a.medicine?.name}),(0,b.jsx)(E.TableCell,{children:a.batch_number}),(0,b.jsx)(E.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,g.format)(new Date(a.expiry_date),"dd MMM yyyy",{locale:h.id}),a.is_expiring_soon&&(0,b.jsx)(w.AlertTriangle,{className:"h-4 w-4 text-yellow-500"})]})}),(0,b.jsxs)(E.TableCell,{className:"text-right",children:[a.quantity," ",a.unit]}),(0,b.jsx)(E.TableCell,{className:"text-right",children:aO(a.unit_price)}),(0,b.jsx)(E.TableCell,{className:"text-right",children:aO(a.total_price)})]},a.id))})]})]}),(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:aO(as.total_amount)})]})})]})]})}),(0,b.jsx)(I.AlertDialog,{open:am,onOpenChange:an,children:(0,b.jsxs)(I.AlertDialogContent,{children:[(0,b.jsxs)(I.AlertDialogHeader,{children:[(0,b.jsx)(I.AlertDialogTitle,{children:"Hapus Penerimaan Barang?"}),(0,b.jsxs)(I.AlertDialogDescription,{children:["Penerimaan ",as?.receipt_number," akan dihapus permanen. Tindakan ini tidak dapat dibatalkan."]})]}),(0,b.jsxs)(I.AlertDialogFooter,{children:[(0,b.jsx)(I.AlertDialogCancel,{children:"Batal"}),(0,b.jsxs)(I.AlertDialogAction,{onClick:aK,className:"bg-red-600 hover:bg-red-700",disabled:au,children:[au&&(0,b.jsx)(u.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Hapus"]})]})]})}),(0,b.jsx)(I.AlertDialog,{open:ao,onOpenChange:ap,children:(0,b.jsxs)(I.AlertDialogContent,{children:[(0,b.jsxs)(I.AlertDialogHeader,{children:[(0,b.jsx)(I.AlertDialogTitle,{children:"Selesaikan Penerimaan Barang?"}),(0,b.jsxs)(I.AlertDialogDescription,{children:["Penerimaan ",as?.receipt_number," akan diselesaikan. Stok obat akan bertambah sesuai item yang diterima dan batch baru akan dibuat.",(0,b.jsx)("br",{}),(0,b.jsx)("br",{}),(0,b.jsx)("strong",{children:"Tindakan ini tidak dapat dibatalkan."})]})]}),(0,b.jsxs)(I.AlertDialogFooter,{children:[(0,b.jsx)(I.AlertDialogCancel,{children:"Batal"}),(0,b.jsxs)(I.AlertDialogAction,{onClick:aL,className:"bg-green-600 hover:bg-green-700",disabled:au,children:[au&&(0,b.jsx)(u.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Selesaikan"]})]})]})})]})}a.s(["default",()=>P])}];

//# sourceMappingURL=src_app_%28dashboard%29_pharmacy_goods-receipt_page_tsx_ee581492._.js.map